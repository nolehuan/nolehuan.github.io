{"title":"cmake","uid":"0929bbafa6d8a8be296315b76b958582","slug":"cpp/cmake","date":"2023-12-02T16:30:29.000Z","updated":"2023-12-02T12:27:21.536Z","comments":true,"path":"api/articles/cpp/cmake.json","cover":null,"content":"<h4 id=\"cmake\"><a href=\"#cmake\" class=\"headerlink\" title=\"cmake\"></a>cmake</h4><p>命令<br><code>add_compile_options</code> 针对所有编译器添加编译选项，CMAKE_C_FLAGS 与 CMAKE_CXX_FLAGS 分别针对 c 和 c++ 编译器<br><code>aux_source_directory(dir var)</code> 将目录中的源文件保存在变量中<br><code>include_directories(dir)</code> 在目录中寻找头文件<br><code>add_library(lib STATIC/SHARED src)</code> 生成库<br><code>set_target_properties</code> 设置目标属性<br><code>add_executable</code> 生成可执行文件<br><code>find_library</code> 查找库<br><code>target_link_Libraries</code> 将库链接到可执行文件<br><code>install</code> 安装配置</p>\n<p>系统变量<br><code>CMAKE_BUILD_TYPE</code> 编译类型<br><code>PROJECT_BINARY_DIR</code> 执行 cmake 命令的目录<br><code>PROJECT_SOURCE_DIR</code> 工程根目录<br><code>LIBRARY_OUTPUT_PATH</code> 库文件生成目录<br><code>EXECUTABLE_OUTPUT_PATH</code> 可执行文件生成目录<br><code>CMAKE_INSTALL_PREFIX</code> 安装路径前缀，DESTINATION 指定绝对路径时无效</p>\n<figure class=\"highlight shell\"><table><tr><td class=\"gutter\"><pre><span class=\"line\">1</span><br><span class=\"line\">2</span><br><span class=\"line\">3</span><br><span class=\"line\">4</span><br><span class=\"line\">5</span><br><span class=\"line\">6</span><br><span class=\"line\">7</span><br><span class=\"line\">8</span><br><span class=\"line\">9</span><br><span class=\"line\">10</span><br><span class=\"line\">11</span><br><span class=\"line\">12</span><br><span class=\"line\">13</span><br><span class=\"line\">14</span><br><span class=\"line\">15</span><br><span class=\"line\">16</span><br><span class=\"line\">17</span><br><span class=\"line\">18</span><br><span class=\"line\">19</span><br><span class=\"line\">20</span><br><span class=\"line\">21</span><br><span class=\"line\">22</span><br><span class=\"line\">23</span><br><span class=\"line\">24</span><br><span class=\"line\">25</span><br><span class=\"line\">26</span><br><span class=\"line\">27</span><br><span class=\"line\">28</span><br><span class=\"line\">29</span><br><span class=\"line\">30</span><br><span class=\"line\">31</span><br><span class=\"line\">32</span><br><span class=\"line\">33</span><br><span class=\"line\">34</span><br><span class=\"line\">35</span><br><span class=\"line\">36</span><br><span class=\"line\">37</span><br></pre></td><td class=\"code\"><pre><span class=\"line\"><span class=\"meta prompt_\">$ </span><span class=\"language-bash\"><span class=\"built_in\">cat</span> CMakeLists.txt</span> </span><br><span class=\"line\">cmake_minimum_required(VERSION 2.8)</span><br><span class=\"line\"></span><br><span class=\"line\">project(cmake_demo)</span><br><span class=\"line\"></span><br><span class=\"line\">set(CMAKE_BUILD_TYPE Debug)</span><br><span class=\"line\"></span><br><span class=\"line\">add_compile_options(-std=c++11 -Wall -O2)</span><br><span class=\"line\"><span class=\"meta prompt_\"></span></span><br><span class=\"line\"><span class=\"meta prompt_\"># </span><span class=\"language-bash\">add_executable(demo main.cpp hello.cpp)</span></span><br><span class=\"line\"><span class=\"meta prompt_\"></span></span><br><span class=\"line\"><span class=\"meta prompt_\"># </span><span class=\"language-bash\">aux_source_directory(./src SRC)</span></span><br><span class=\"line\">aux_source_directory(. MAIN)</span><br><span class=\"line\"></span><br><span class=\"line\">include_directories(./include)</span><br><span class=\"line\"><span class=\"meta prompt_\"></span></span><br><span class=\"line\"><span class=\"meta prompt_\"># </span><span class=\"language-bash\">add_library(hello_shared SHARED <span class=\"variable\">$&#123;SRC&#125;</span>)</span></span><br><span class=\"line\"><span class=\"meta prompt_\"># </span><span class=\"language-bash\">add_library(hello_static STATIC <span class=\"variable\">$&#123;SRC&#125;</span>)</span></span><br><span class=\"line\"><span class=\"meta prompt_\"></span></span><br><span class=\"line\"><span class=\"meta prompt_\"># </span><span class=\"language-bash\">set_target_properties(hello_shared PROPERTIES OUTPUT_NAME <span class=\"string\">&quot;hello_shared&quot;</span>)</span></span><br><span class=\"line\"><span class=\"meta prompt_\"># </span><span class=\"language-bash\">set_target_properties(hello_static PROPERTIES OUTPUT_NAME <span class=\"string\">&quot;hello_static&quot;</span>)</span></span><br><span class=\"line\"><span class=\"meta prompt_\"></span></span><br><span class=\"line\"><span class=\"meta prompt_\"># </span><span class=\"language-bash\"><span class=\"built_in\">set</span>(LIBRARY_OUTPUT_PATH <span class=\"variable\">$&#123;PROJECT_BINARY_DIR&#125;</span>/../lib)</span></span><br><span class=\"line\"><span class=\"meta prompt_\"># </span><span class=\"language-bash\"><span class=\"built_in\">set</span>(LIBRARY_OUTPUT_PATH <span class=\"variable\">$&#123;PROJECT_SOURCE_DIR&#125;</span>/lib)</span></span><br><span class=\"line\"><span class=\"meta prompt_\"></span></span><br><span class=\"line\"><span class=\"meta prompt_\"># </span><span class=\"language-bash\">add_executable(demo <span class=\"variable\">$&#123;MAIN&#125;</span> <span class=\"variable\">$&#123;SRC&#125;</span>)</span></span><br><span class=\"line\"></span><br><span class=\"line\">find_library(LIB hello_shared $&#123;PROJECT_SOURCE_DIR&#125;/lib)</span><br><span class=\"line\"></span><br><span class=\"line\">set(EXECUTABLE_OUTPUT_PATH $&#123;PROJECT_SOURCE_DIR&#125;)</span><br><span class=\"line\"></span><br><span class=\"line\">add_executable(demo $&#123;MAIN&#125;)</span><br><span class=\"line\"></span><br><span class=\"line\">target_link_Libraries(demo $&#123;LIB&#125;)</span><br><span class=\"line\"></span><br><span class=\"line\">set(CMAKE_INSTALL_PREFIX $&#123;PROJECT_SOURCE_DIR&#125;)</span><br><span class=\"line\">install(TARGETS demo DESTINATION $&#123;PROJECT_SOURCE_DIR&#125;/install/)</span><br></pre></td></tr></table></figure>\n<figure class=\"highlight shell\"><table><tr><td class=\"gutter\"><pre><span class=\"line\">1</span><br><span class=\"line\">2</span><br><span class=\"line\">3</span><br><span class=\"line\">4</span><br><span class=\"line\">5</span><br><span class=\"line\">6</span><br><span class=\"line\">7</span><br><span class=\"line\">8</span><br><span class=\"line\">9</span><br><span class=\"line\">10</span><br><span class=\"line\">11</span><br><span class=\"line\">12</span><br><span class=\"line\">13</span><br><span class=\"line\">14</span><br><span class=\"line\">15</span><br><span class=\"line\">16</span><br><span class=\"line\">17</span><br><span class=\"line\">18</span><br><span class=\"line\">19</span><br></pre></td><td class=\"code\"><pre><span class=\"line\"><span class=\"meta prompt_\">$ </span><span class=\"language-bash\">tree .</span></span><br><span class=\"line\">.</span><br><span class=\"line\">├── build</span><br><span class=\"line\">│   ├── CMakeCache.txt</span><br><span class=\"line\">│   ├── CMakeFiles</span><br><span class=\"line\">│   ├── cmake_install.cmake</span><br><span class=\"line\">│   └── Makefile</span><br><span class=\"line\">├── CMakeLists.txt</span><br><span class=\"line\">├── demo</span><br><span class=\"line\">├── include</span><br><span class=\"line\">│   └── hello.h</span><br><span class=\"line\">├── lib</span><br><span class=\"line\">│   ├── libhello_shared.so</span><br><span class=\"line\">│   └── libhello_static.a</span><br><span class=\"line\">├── main.cpp</span><br><span class=\"line\">└── src</span><br><span class=\"line\">    └── hello.cpp</span><br><span class=\"line\"></span><br><span class=\"line\">5 directories, 10 files</span><br></pre></td></tr></table></figure>\n<h4 id=\"参考\"><a href=\"#参考\" class=\"headerlink\" title=\"参考\"></a>参考</h4><p><a href=\"https://blog.csdn.net/iuu77/article/details/129229361\">https://blog.csdn.net/iuu77/article/details/129229361</a></p>\n","feature":false,"text":"cmake...","permalink":"/post/cpp/cmake","photos":[],"count_time":{"symbolsCount":"2k","symbolsTime":"2 mins."},"categories":[{"name":"coding","slug":"coding","count":4,"path":"api/categories/coding.json"}],"tags":[{"name":"cpp","slug":"cpp","count":5,"path":"api/tags/cpp.json"},{"name":"cmake","slug":"cmake","count":1,"path":"api/tags/cmake.json"}],"toc":"<ol class=\"toc\"><li class=\"toc-item toc-level-4\"><a class=\"toc-link\" href=\"#cmake\"><span class=\"toc-text\">cmake</span></a></li><li class=\"toc-item toc-level-4\"><a class=\"toc-link\" href=\"#%E5%8F%82%E8%80%83\"><span class=\"toc-text\">参考</span></a></li></ol>","author":{"name":"NoleHuan","slug":"blog-author","avatar":"/img/tennis_logo.svg","link":"/","description":"The true nature of a heart is seen in its response to the unattractive.","socials":{"github":"https://github.com/nolehuan","twitter":"","stackoverflow":"","wechat":"","qq":"","weibo":"https://weibo.com/u/5948495997","zhihu":"","csdn":"","juejin":"","customs":{}}},"mapped":true,"hidden":false,"prev_post":{"title":"op","uid":"7790d923d44c9f611a31c98e9aa24f9f","slug":"linux/op","date":"2023-12-02T20:00:29.000Z","updated":"2023-12-09T07:25:46.545Z","comments":true,"path":"api/articles/linux/op.json","cover":null,"text":"optimise...","permalink":"/post/linux/op","photos":[],"count_time":{"symbolsCount":421,"symbolsTime":"1 mins."},"categories":[{"name":"coding","slug":"coding","count":4,"path":"api/categories/coding.json"}],"tags":[{"name":"cpp","slug":"cpp","count":5,"path":"api/tags/cpp.json"}],"author":{"name":"NoleHuan","slug":"blog-author","avatar":"/img/tennis_logo.svg","link":"/","description":"The true nature of a heart is seen in its response to the unattractive.","socials":{"github":"https://github.com/nolehuan","twitter":"","stackoverflow":"","wechat":"","qq":"","weibo":"https://weibo.com/u/5948495997","zhihu":"","csdn":"","juejin":"","customs":{}}},"feature":true},"next_post":{"title":"strip","uid":"a411c58a70d71608d7e89379b3a77f8e","slug":"linux/strip","date":"2023-11-30T21:20:29.000Z","updated":"2023-12-03T04:57:10.204Z","comments":true,"path":"api/articles/linux/strip.json","cover":null,"text":"动态库裁剪...","permalink":"/post/linux/strip","photos":[],"count_time":{"symbolsCount":"46k","symbolsTime":"42 mins."},"categories":[{"name":"script","slug":"script","count":2,"path":"api/categories/script.json"}],"tags":[{"name":"shell","slug":"shell","count":2,"path":"api/tags/shell.json"},{"name":"so","slug":"so","count":2,"path":"api/tags/so.json"}],"author":{"name":"NoleHuan","slug":"blog-author","avatar":"/img/tennis_logo.svg","link":"/","description":"The true nature of a heart is seen in its response to the unattractive.","socials":{"github":"https://github.com/nolehuan","twitter":"","stackoverflow":"","wechat":"","qq":"","weibo":"https://weibo.com/u/5948495997","zhihu":"","csdn":"","juejin":"","customs":{}}},"feature":false}}