[{"id":"a411c58a70d71608d7e89379b3a77f8e","title":"strip","content":"strip\n\n-s --strip-all 删除所有符号和重定位信息，.dynsym 和 .dynstr 表信息依然存在，用于动态链接库链接使用\n\n123456789101112131415161718192021222324252627282930313233343536373839404142434445464748495051525354555657585960616263646566676869707172737475767778798081828384858687888990919293949596979899100101102103$ ll | grep libtest.so-rwxrwxr-x 1 nolehuan nolehuan 10480 11月 26 18:32 libtest.so*$ readelf -s libtest.so Symbol table &#x27;.dynsym&#x27; contains 13 entries:   Num:    Value          Size Type    Bind   Vis      Ndx Name     0: 0000000000000000     0 NOTYPE  LOCAL  DEFAULT  UND      1: 0000000000000000     0 NOTYPE  WEAK   DEFAULT  UND _ITM_deregisterTMCloneTab     2: 0000000000000000     0 FUNC    GLOBAL DEFAULT  UND puts@GLIBC_2.2.5 (2)     3: 0000000000000000     0 NOTYPE  WEAK   DEFAULT  UND __gmon_start__     4: 0000000000000000     0 NOTYPE  WEAK   DEFAULT  UND _ITM_registerTMCloneTable     5: 0000000000000000     0 FUNC    WEAK   DEFAULT  UND __cxa_finalize@GLIBC_2.2.5 (2)     6: 0000000000201028     0 NOTYPE  GLOBAL DEFAULT   22 _edata     7: 0000000000201030     0 NOTYPE  GLOBAL DEFAULT   23 _end     8: 000000000000063d    32 FUNC    GLOBAL DEFAULT   12 add     9: 0000000000201028     0 NOTYPE  GLOBAL DEFAULT   23 __bss_start    10: 0000000000000500     0 FUNC    GLOBAL DEFAULT    9 _init    11: 0000000000000660     0 FUNC    GLOBAL DEFAULT   13 _fini    12: 000000000000062a    19 FUNC    GLOBAL DEFAULT   12 funcSymbol table &#x27;.symtab&#x27; contains 59 entries:   Num:    Value          Size Type    Bind   Vis      Ndx Name     0: 0000000000000000     0 NOTYPE  LOCAL  DEFAULT  UND      1: 00000000000001c8     0 SECTION LOCAL  DEFAULT    1      2: 00000000000001f0     0 SECTION LOCAL  DEFAULT    2      3: 0000000000000230     0 SECTION LOCAL  DEFAULT    3      4: 0000000000000368     0 SECTION LOCAL  DEFAULT    4      5: 0000000000000406     0 SECTION LOCAL  DEFAULT    5      6: 0000000000000420     0 SECTION LOCAL  DEFAULT    6      7: 0000000000000440     0 SECTION LOCAL  DEFAULT    7      8: 00000000000004e8     0 SECTION LOCAL  DEFAULT    8      9: 0000000000000500     0 SECTION LOCAL  DEFAULT    9     10: 0000000000000520     0 SECTION LOCAL  DEFAULT   10     11: 0000000000000540     0 SECTION LOCAL  DEFAULT   11     12: 0000000000000550     0 SECTION LOCAL  DEFAULT   12     13: 0000000000000660     0 SECTION LOCAL  DEFAULT   13     14: 0000000000000669     0 SECTION LOCAL  DEFAULT   14     15: 0000000000000674     0 SECTION LOCAL  DEFAULT   15     16: 00000000000006a0     0 SECTION LOCAL  DEFAULT   16     17: 0000000000200e10     0 SECTION LOCAL  DEFAULT   17     18: 0000000000200e18     0 SECTION LOCAL  DEFAULT   18     19: 0000000000200e20     0 SECTION LOCAL  DEFAULT   19     20: 0000000000200fe0     0 SECTION LOCAL  DEFAULT   20     21: 0000000000201000     0 SECTION LOCAL  DEFAULT   21     22: 0000000000201020     0 SECTION LOCAL  DEFAULT   22     23: 0000000000201028     0 SECTION LOCAL  DEFAULT   23     24: 0000000000000000     0 SECTION LOCAL  DEFAULT   24     25: 0000000000000000     0 SECTION LOCAL  DEFAULT   25     26: 0000000000000000     0 SECTION LOCAL  DEFAULT   26     27: 0000000000000000     0 SECTION LOCAL  DEFAULT   27     28: 0000000000000000     0 SECTION LOCAL  DEFAULT   28     29: 0000000000000000     0 SECTION LOCAL  DEFAULT   29     30: 0000000000000000     0 FILE    LOCAL  DEFAULT  ABS crtstuff.c    31: 0000000000000550     0 FUNC    LOCAL  DEFAULT   12 deregister_tm_clones    32: 0000000000000590     0 FUNC    LOCAL  DEFAULT   12 register_tm_clones    33: 00000000000005e0     0 FUNC    LOCAL  DEFAULT   12 __do_global_dtors_aux    34: 0000000000201028     1 OBJECT  LOCAL  DEFAULT   23 completed.7698    35: 0000000000200e18     0 OBJECT  LOCAL  DEFAULT   18 __do_global_dtors_aux_fin    36: 0000000000000620     0 FUNC    LOCAL  DEFAULT   12 frame_dummy    37: 0000000000200e10     0 OBJECT  LOCAL  DEFAULT   17 __frame_dummy_init_array_    38: 0000000000000000     0 FILE    LOCAL  DEFAULT  ABS libtest.c    39: 0000000000000000     0 FILE    LOCAL  DEFAULT  ABS crtstuff.c    40: 0000000000000738     0 OBJECT  LOCAL  DEFAULT   16 __FRAME_END__    41: 0000000000000000     0 FILE    LOCAL  DEFAULT  ABS     42: 0000000000201020     0 OBJECT  LOCAL  DEFAULT   22 __dso_handle    43: 0000000000200e20     0 OBJECT  LOCAL  DEFAULT   19 _DYNAMIC    44: 0000000000000674     0 NOTYPE  LOCAL  DEFAULT   15 __GNU_EH_FRAME_HDR    45: 0000000000201028     0 OBJECT  LOCAL  DEFAULT   22 __TMC_END__    46: 0000000000201000     0 OBJECT  LOCAL  DEFAULT   21 _GLOBAL_OFFSET_TABLE_    47: 0000000000000000     0 NOTYPE  WEAK   DEFAULT  UND _ITM_deregisterTMCloneTab    48: 000000000000063d    32 FUNC    GLOBAL DEFAULT   12 add    49: 0000000000000000     0 FUNC    GLOBAL DEFAULT  UND puts@@GLIBC_2.2.5    50: 0000000000201028     0 NOTYPE  GLOBAL DEFAULT   22 _edata    51: 0000000000000660     0 FUNC    GLOBAL DEFAULT   13 _fini    52: 0000000000000000     0 NOTYPE  WEAK   DEFAULT  UND __gmon_start__    53: 000000000000062a    19 FUNC    GLOBAL DEFAULT   12 func    54: 0000000000201030     0 NOTYPE  GLOBAL DEFAULT   23 _end    55: 0000000000201028     0 NOTYPE  GLOBAL DEFAULT   23 __bss_start    56: 0000000000000000     0 NOTYPE  WEAK   DEFAULT  UND _ITM_registerTMCloneTable    57: 0000000000000000     0 FUNC    WEAK   DEFAULT  UND __cxa_finalize@@GLIBC_2.2    58: 0000000000000500     0 FUNC    GLOBAL DEFAULT    9 _init$ strip -s libtest.so$ readelf -s libtest.so Symbol table &#x27;.dynsym&#x27; contains 13 entries:   Num:    Value          Size Type    Bind   Vis      Ndx Name     0: 0000000000000000     0 NOTYPE  LOCAL  DEFAULT  UND      1: 0000000000000000     0 NOTYPE  WEAK   DEFAULT  UND _ITM_deregisterTMCloneTab     2: 0000000000000000     0 FUNC    GLOBAL DEFAULT  UND puts@GLIBC_2.2.5 (2)     3: 0000000000000000     0 NOTYPE  WEAK   DEFAULT  UND __gmon_start__     4: 0000000000000000     0 NOTYPE  WEAK   DEFAULT  UND _ITM_registerTMCloneTable     5: 0000000000000000     0 FUNC    WEAK   DEFAULT  UND __cxa_finalize@GLIBC_2.2.5 (2)     6: 0000000000201028     0 NOTYPE  GLOBAL DEFAULT   22 _edata     7: 0000000000201030     0 NOTYPE  GLOBAL DEFAULT   23 _end     8: 000000000000063d    32 FUNC    GLOBAL DEFAULT   12 add     9: 0000000000201028     0 NOTYPE  GLOBAL DEFAULT   23 __bss_start    10: 0000000000000500     0 FUNC    GLOBAL DEFAULT    9 _init    11: 0000000000000660     0 FUNC    GLOBAL DEFAULT   13 _fini    12: 000000000000062a    19 FUNC    GLOBAL DEFAULT   12 func$ ll | grep libtest.so-rwxrwxr-x 1 nolehuan nolehuan  6072 11月 30 21:40 libtest.so*\n\n-g -S -d --strip-debug 删除所有调试符号和段\n\n1234$ ll | grep libtest.so-rwxrwxr-x 1 nolehuan nolehuan 10480 11月 30 22:02 libtest.so*$ strip --strip-debug libtest.so$ ll | grep libtest.so\n以下信息被删除123456...    30: 0000000000000000     0 FILE    LOCAL  DEFAULT  ABS crtstuff.c...    38: 0000000000000000     0 FILE    LOCAL  DEFAULT  ABS libtest.c    39: 0000000000000000     0 FILE    LOCAL  DEFAULT  ABS crtstuff.c...\n\ndetails\n\n123456789101112131415161718192021222324252627282930313233343536373839404142434445464748495051525354555657585960616263646566676869707172737475767778798081828384858687888990919293949596979899100101102103104105106107108109110111112113114115116117118119120121122123124125126127128129130131132133134135136137138139140141142143144145146147148149150151152153154155156157158159160161162163164165166167168169170171172173174175176177178179180181182183184185186187188189190191192193194195196197198199200201202203204205206207208209210211212213214215216217218219220221222223224225226227228229230231232233234235236237238239240241242243244245246247248249250251252253254255256257258259260261262263264265266267268269270271272273274275276277278279280281282283284285286287288289290291292293294295296297298299300301302303304305306307308309310311312313314315316317318319320321322323324325326327328329330331332333334335336337338339340341342343344345346347348349350351352353354355356357358359360361362363364365366367368369370371372373374375376377378379380381382383384385386387388389390391392393394395396397398399400401402403404405406407408409410411412413414415416417418419420421422423424425426427428429430431432433434435436437438439440441442443444445446447448449450451452453454455456457458459460461462463464465466467468469470471472473474475476477478479480481482483484485486487488489490491492493494495496497498499500501502503504505506507508509510511512513514515516517518519520521522523524525526$ readelf -a libtest.soELF Header:  Magic:   7f 45 4c 46 02 01 01 00 00 00 00 00 00 00 00 00   Class:                             ELF64  Data:                              2&#x27;s complement, little endian  Version:                           1 (current)  OS/ABI:                            UNIX - System V  ABI Version:                       0  Type:                              DYN (Shared object file)  Machine:                           Advanced Micro Devices X86-64  Version:                           0x1  Entry point address:               0x550  Start of program headers:          64 (bytes into file)  Start of section headers:          8368 (bytes into file)  Flags:                             0x0  Size of this header:               64 (bytes)  Size of program headers:           56 (bytes)  Number of program headers:         7  Size of section headers:           64 (bytes)  Number of section headers:         33  Section header string table index: 32Section Headers:  [Nr] Name              Type             Address           Offset       Size              EntSize          Flags  Link  Info  Align  [ 0]                   NULL             0000000000000000  00000000       0000000000000000  0000000000000000           0     0     0  [ 1] .note.gnu.build-i NOTE             00000000000001c8  000001c8       0000000000000024  0000000000000000   A       0     0     4  [ 2] .gnu.hash         GNU_HASH         00000000000001f0  000001f0       0000000000000040  0000000000000000   A       3     0     8  [ 3] .dynsym           DYNSYM           0000000000000230  00000230       0000000000000138  0000000000000018   A       4     1     8  [ 4] .dynstr           STRTAB           0000000000000368  00000368       000000000000009d  0000000000000000   A       0     0     1  [ 5] .gnu.version      VERSYM           0000000000000406  00000406       000000000000001a  0000000000000002   A       3     0     2  [ 6] .gnu.version_r    VERNEED          0000000000000420  00000420       0000000000000020  0000000000000000   A       4     1     8  [ 7] .rela.dyn         RELA             0000000000000440  00000440       00000000000000a8  0000000000000018   A       3     0     8  [ 8] .rela.plt         RELA             00000000000004e8  000004e8       0000000000000018  0000000000000018  AI       3    21     8  [ 9] .init             PROGBITS         0000000000000500  00000500       0000000000000017  0000000000000000  AX       0     0     4  [10] .plt              PROGBITS         0000000000000520  00000520       0000000000000020  0000000000000010  AX       0     0     16  [11] .plt.got          PROGBITS         0000000000000540  00000540       0000000000000008  0000000000000008  AX       0     0     8  [12] .text             PROGBITS         0000000000000550  00000550       000000000000010d  0000000000000000  AX       0     0     16  [13] .fini             PROGBITS         0000000000000660  00000660       0000000000000009  0000000000000000  AX       0     0     4  [14] .rodata           PROGBITS         0000000000000669  00000669       0000000000000008  0000000000000000   A       0     0     1  [15] .eh_frame_hdr     PROGBITS         0000000000000674  00000674       000000000000002c  0000000000000000   A       0     0     4  [16] .eh_frame         PROGBITS         00000000000006a0  000006a0       000000000000009c  0000000000000000   A       0     0     8  [17] .init_array       INIT_ARRAY       0000000000200e10  00000e10       0000000000000008  0000000000000008  WA       0     0     8  [18] .fini_array       FINI_ARRAY       0000000000200e18  00000e18       0000000000000008  0000000000000008  WA       0     0     8  [19] .dynamic          DYNAMIC          0000000000200e20  00000e20       00000000000001c0  0000000000000010  WA       4     0     8  [20] .got              PROGBITS         0000000000200fe0  00000fe0       0000000000000020  0000000000000008  WA       0     0     8  [21] .got.plt          PROGBITS         0000000000201000  00001000       0000000000000020  0000000000000008  WA       0     0     8  [22] .data             PROGBITS         0000000000201020  00001020       0000000000000008  0000000000000000  WA       0     0     8  [23] .bss              NOBITS           0000000000201028  00001028       0000000000000008  0000000000000000  WA       0     0     1  [24] .comment          PROGBITS         0000000000000000  00001028       0000000000000029  0000000000000001  MS       0     0     1  [25] .debug_aranges    PROGBITS         0000000000000000  00001051       0000000000000030  0000000000000000           0     0     1  [26] .debug_info       PROGBITS         0000000000000000  00001081       000000000000035b  0000000000000000           0     0     1  [27] .debug_abbrev     PROGBITS         0000000000000000  000013dc       0000000000000109  0000000000000000           0     0     1  [28] .debug_line       PROGBITS         0000000000000000  000014e5       00000000000000d7  0000000000000000           0     0     1  [29] .debug_str        PROGBITS         0000000000000000  000015bc       0000000000000296  0000000000000001  MS       0     0     1  [30] .symtab           SYMTAB           0000000000000000  00001858       0000000000000588  0000000000000018          31    47     8  [31] .strtab           STRTAB           0000000000000000  00001de0       000000000000019b  0000000000000000           0     0     1  [32] .shstrtab         STRTAB           0000000000000000  00001f7b       0000000000000131  0000000000000000           0     0     1Key to Flags:  W (write), A (alloc), X (execute), M (merge), S (strings), I (info),  L (link order), O (extra OS processing required), G (group), T (TLS),  C (compressed), x (unknown), o (OS specific), E (exclude),  l (large), p (processor specific)There are no section groups in this file.Program Headers:  Type           Offset             VirtAddr           PhysAddr                 FileSiz            MemSiz              Flags  Align  LOAD           0x0000000000000000 0x0000000000000000 0x0000000000000000                 0x000000000000073c 0x000000000000073c  R E    0x200000  LOAD           0x0000000000000e10 0x0000000000200e10 0x0000000000200e10                 0x0000000000000218 0x0000000000000220  RW     0x200000  DYNAMIC        0x0000000000000e20 0x0000000000200e20 0x0000000000200e20                 0x00000000000001c0 0x00000000000001c0  RW     0x8  NOTE           0x00000000000001c8 0x00000000000001c8 0x00000000000001c8                 0x0000000000000024 0x0000000000000024  R      0x4  GNU_EH_FRAME   0x0000000000000674 0x0000000000000674 0x0000000000000674                 0x000000000000002c 0x000000000000002c  R      0x4  GNU_STACK      0x0000000000000000 0x0000000000000000 0x0000000000000000                 0x0000000000000000 0x0000000000000000  RW     0x10  GNU_RELRO      0x0000000000000e10 0x0000000000200e10 0x0000000000200e10                 0x00000000000001f0 0x00000000000001f0  R      0x1 Section to Segment mapping:  Segment Sections...   00     .note.gnu.build-id .gnu.hash .dynsym .dynstr .gnu.version .gnu.version_r .rela.dyn .rela.plt .init .plt .plt.got .text .fini .rodata .eh_frame_hdr .eh_frame    01     .init_array .fini_array .dynamic .got .got.plt .data .bss    02     .dynamic    03     .note.gnu.build-id    04     .eh_frame_hdr    05        06     .init_array .fini_array .dynamic .got Dynamic section at offset 0xe20 contains 24 entries:  Tag        Type                         Name/Value 0x0000000000000001 (NEEDED)             Shared library: [libc.so.6] 0x000000000000000c (INIT)               0x500 0x000000000000000d (FINI)               0x660 0x0000000000000019 (INIT_ARRAY)         0x200e10 0x000000000000001b (INIT_ARRAYSZ)       8 (bytes) 0x000000000000001a (FINI_ARRAY)         0x200e18 0x000000000000001c (FINI_ARRAYSZ)       8 (bytes) 0x000000006ffffef5 (GNU_HASH)           0x1f0 0x0000000000000005 (STRTAB)             0x368 0x0000000000000006 (SYMTAB)             0x230 0x000000000000000a (STRSZ)              157 (bytes) 0x000000000000000b (SYMENT)             24 (bytes) 0x0000000000000003 (PLTGOT)             0x201000 0x0000000000000002 (PLTRELSZ)           24 (bytes) 0x0000000000000014 (PLTREL)             RELA 0x0000000000000017 (JMPREL)             0x4e8 0x0000000000000007 (RELA)               0x440 0x0000000000000008 (RELASZ)             168 (bytes) 0x0000000000000009 (RELAENT)            24 (bytes) 0x000000006ffffffe (VERNEED)            0x420 0x000000006fffffff (VERNEEDNUM)         1 0x000000006ffffff0 (VERSYM)             0x406 0x000000006ffffff9 (RELACOUNT)          3 0x0000000000000000 (NULL)               0x0Relocation section &#x27;.rela.dyn&#x27; at offset 0x440 contains 7 entries:  Offset          Info           Type           Sym. Value    Sym. Name + Addend000000200e10  000000000008 R_X86_64_RELATIVE                    620000000200e18  000000000008 R_X86_64_RELATIVE                    5e0000000201020  000000000008 R_X86_64_RELATIVE                    201020000000200fe0  000100000006 R_X86_64_GLOB_DAT 0000000000000000 _ITM_deregisterTMClone + 0000000200fe8  000300000006 R_X86_64_GLOB_DAT 0000000000000000 __gmon_start__ + 0000000200ff0  000400000006 R_X86_64_GLOB_DAT 0000000000000000 _ITM_registerTMCloneTa + 0000000200ff8  000500000006 R_X86_64_GLOB_DAT 0000000000000000 __cxa_finalize@GLIBC_2.2.5 + 0Relocation section &#x27;.rela.plt&#x27; at offset 0x4e8 contains 1 entry:  Offset          Info           Type           Sym. Value    Sym. Name + Addend000000201018  000200000007 R_X86_64_JUMP_SLO 0000000000000000 puts@GLIBC_2.2.5 + 0The decoding of unwind sections for machine type Advanced Micro Devices X86-64 is not currently supported.Symbol table &#x27;.dynsym&#x27; contains 13 entries:   Num:    Value          Size Type    Bind   Vis      Ndx Name     0: 0000000000000000     0 NOTYPE  LOCAL  DEFAULT  UND      1: 0000000000000000     0 NOTYPE  WEAK   DEFAULT  UND _ITM_deregisterTMCloneTab     2: 0000000000000000     0 FUNC    GLOBAL DEFAULT  UND puts@GLIBC_2.2.5 (2)     3: 0000000000000000     0 NOTYPE  WEAK   DEFAULT  UND __gmon_start__     4: 0000000000000000     0 NOTYPE  WEAK   DEFAULT  UND _ITM_registerTMCloneTable     5: 0000000000000000     0 FUNC    WEAK   DEFAULT  UND __cxa_finalize@GLIBC_2.2.5 (2)     6: 0000000000201028     0 NOTYPE  GLOBAL DEFAULT   22 _edata     7: 0000000000201030     0 NOTYPE  GLOBAL DEFAULT   23 _end     8: 000000000000063d    32 FUNC    GLOBAL DEFAULT   12 add     9: 0000000000201028     0 NOTYPE  GLOBAL DEFAULT   23 __bss_start    10: 0000000000000500     0 FUNC    GLOBAL DEFAULT    9 _init    11: 0000000000000660     0 FUNC    GLOBAL DEFAULT   13 _fini    12: 000000000000062a    19 FUNC    GLOBAL DEFAULT   12 funcSymbol table &#x27;.symtab&#x27; contains 59 entries:   Num:    Value          Size Type    Bind   Vis      Ndx Name     0: 0000000000000000     0 NOTYPE  LOCAL  DEFAULT  UND      1: 00000000000001c8     0 SECTION LOCAL  DEFAULT    1      2: 00000000000001f0     0 SECTION LOCAL  DEFAULT    2      3: 0000000000000230     0 SECTION LOCAL  DEFAULT    3      4: 0000000000000368     0 SECTION LOCAL  DEFAULT    4      5: 0000000000000406     0 SECTION LOCAL  DEFAULT    5      6: 0000000000000420     0 SECTION LOCAL  DEFAULT    6      7: 0000000000000440     0 SECTION LOCAL  DEFAULT    7      8: 00000000000004e8     0 SECTION LOCAL  DEFAULT    8      9: 0000000000000500     0 SECTION LOCAL  DEFAULT    9     10: 0000000000000520     0 SECTION LOCAL  DEFAULT   10     11: 0000000000000540     0 SECTION LOCAL  DEFAULT   11     12: 0000000000000550     0 SECTION LOCAL  DEFAULT   12     13: 0000000000000660     0 SECTION LOCAL  DEFAULT   13     14: 0000000000000669     0 SECTION LOCAL  DEFAULT   14     15: 0000000000000674     0 SECTION LOCAL  DEFAULT   15     16: 00000000000006a0     0 SECTION LOCAL  DEFAULT   16     17: 0000000000200e10     0 SECTION LOCAL  DEFAULT   17     18: 0000000000200e18     0 SECTION LOCAL  DEFAULT   18     19: 0000000000200e20     0 SECTION LOCAL  DEFAULT   19     20: 0000000000200fe0     0 SECTION LOCAL  DEFAULT   20     21: 0000000000201000     0 SECTION LOCAL  DEFAULT   21     22: 0000000000201020     0 SECTION LOCAL  DEFAULT   22     23: 0000000000201028     0 SECTION LOCAL  DEFAULT   23     24: 0000000000000000     0 SECTION LOCAL  DEFAULT   24     25: 0000000000000000     0 SECTION LOCAL  DEFAULT   25     26: 0000000000000000     0 SECTION LOCAL  DEFAULT   26     27: 0000000000000000     0 SECTION LOCAL  DEFAULT   27     28: 0000000000000000     0 SECTION LOCAL  DEFAULT   28     29: 0000000000000000     0 SECTION LOCAL  DEFAULT   29     30: 0000000000000000     0 FILE    LOCAL  DEFAULT  ABS crtstuff.c    31: 0000000000000550     0 FUNC    LOCAL  DEFAULT   12 deregister_tm_clones    32: 0000000000000590     0 FUNC    LOCAL  DEFAULT   12 register_tm_clones    33: 00000000000005e0     0 FUNC    LOCAL  DEFAULT   12 __do_global_dtors_aux    34: 0000000000201028     1 OBJECT  LOCAL  DEFAULT   23 completed.7698    35: 0000000000200e18     0 OBJECT  LOCAL  DEFAULT   18 __do_global_dtors_aux_fin    36: 0000000000000620     0 FUNC    LOCAL  DEFAULT   12 frame_dummy    37: 0000000000200e10     0 OBJECT  LOCAL  DEFAULT   17 __frame_dummy_init_array_    38: 0000000000000000     0 FILE    LOCAL  DEFAULT  ABS libtest.c    39: 0000000000000000     0 FILE    LOCAL  DEFAULT  ABS crtstuff.c    40: 0000000000000738     0 OBJECT  LOCAL  DEFAULT   16 __FRAME_END__    41: 0000000000000000     0 FILE    LOCAL  DEFAULT  ABS     42: 0000000000201020     0 OBJECT  LOCAL  DEFAULT   22 __dso_handle    43: 0000000000200e20     0 OBJECT  LOCAL  DEFAULT   19 _DYNAMIC    44: 0000000000000674     0 NOTYPE  LOCAL  DEFAULT   15 __GNU_EH_FRAME_HDR    45: 0000000000201028     0 OBJECT  LOCAL  DEFAULT   22 __TMC_END__    46: 0000000000201000     0 OBJECT  LOCAL  DEFAULT   21 _GLOBAL_OFFSET_TABLE_    47: 0000000000000000     0 NOTYPE  WEAK   DEFAULT  UND _ITM_deregisterTMCloneTab    48: 000000000000063d    32 FUNC    GLOBAL DEFAULT   12 add    49: 0000000000000000     0 FUNC    GLOBAL DEFAULT  UND puts@@GLIBC_2.2.5    50: 0000000000201028     0 NOTYPE  GLOBAL DEFAULT   22 _edata    51: 0000000000000660     0 FUNC    GLOBAL DEFAULT   13 _fini    52: 0000000000000000     0 NOTYPE  WEAK   DEFAULT  UND __gmon_start__    53: 000000000000062a    19 FUNC    GLOBAL DEFAULT   12 func    54: 0000000000201030     0 NOTYPE  GLOBAL DEFAULT   23 _end    55: 0000000000201028     0 NOTYPE  GLOBAL DEFAULT   23 __bss_start    56: 0000000000000000     0 NOTYPE  WEAK   DEFAULT  UND _ITM_registerTMCloneTable    57: 0000000000000000     0 FUNC    WEAK   DEFAULT  UND __cxa_finalize@@GLIBC_2.2    58: 0000000000000500     0 FUNC    GLOBAL DEFAULT    9 _initHistogram for `.gnu.hash&#x27; bucket list length (total of 3 buckets): Length  Number     % of total  Coverage      0  0          (  0.0%)      1  0          (  0.0%)      0.0%      2  2          ( 66.7%)     57.1%      3  1          ( 33.3%)    100.0%Version symbols section &#x27;.gnu.version&#x27; contains 13 entries: Addr: 0000000000000406  Offset: 0x000406  Link: 3 (.dynsym)  000:   0 (*local*)       0 (*local*)       2 (GLIBC_2.2.5)   0 (*local*)      004:   0 (*local*)       2 (GLIBC_2.2.5)   1 (*global*)      1 (*global*)     008:   1 (*global*)      1 (*global*)      1 (*global*)      1 (*global*)     00c:   1 (*global*)   Version needs section &#x27;.gnu.version_r&#x27; contains 1 entry: Addr: 0x0000000000000420  Offset: 0x000420  Link: 4 (.dynstr)  000000: Version: 1  File: libc.so.6  Cnt: 1  0x0010:   Name: GLIBC_2.2.5  Flags: none  Version: 2Displaying notes found in: .note.gnu.build-id  Owner                 Data size\tDescription  GNU                  0x00000014\tNT_GNU_BUILD_ID (unique build ID bitstring)    Build ID: 3a6987a7f71f453637ab35daa89ec141fba9026b$ strip --strip-debug libtest.so$ readelf -a libtest.soELF Header:  Magic:   7f 45 4c 46 02 01 01 00 00 00 00 00 00 00 00 00   Class:                             ELF64  Data:                              2&#x27;s complement, little endian  Version:                           1 (current)  OS/ABI:                            UNIX - System V  ABI Version:                       0  Type:                              DYN (Shared object file)  Machine:                           Advanced Micro Devices X86-64  Version:                           0x1  Entry point address:               0x550  Start of program headers:          64 (bytes into file)  Start of section headers:          6016 (bytes into file)  Flags:                             0x0  Size of this header:               64 (bytes)  Size of program headers:           56 (bytes)  Number of program headers:         7  Size of section headers:           64 (bytes)  Number of section headers:         28  Section header string table index: 27Section Headers:  [Nr] Name              Type             Address           Offset       Size              EntSize          Flags  Link  Info  Align  [ 0]                   NULL             0000000000000000  00000000       0000000000000000  0000000000000000           0     0     0  [ 1] .note.gnu.build-i NOTE             00000000000001c8  000001c8       0000000000000024  0000000000000000   A       0     0     4  [ 2] .gnu.hash         GNU_HASH         00000000000001f0  000001f0       0000000000000040  0000000000000000   A       3     0     8  [ 3] .dynsym           DYNSYM           0000000000000230  00000230       0000000000000138  0000000000000018   A       4     1     8  [ 4] .dynstr           STRTAB           0000000000000368  00000368       000000000000009d  0000000000000000   A       0     0     1  [ 5] .gnu.version      VERSYM           0000000000000406  00000406       000000000000001a  0000000000000002   A       3     0     2  [ 6] .gnu.version_r    VERNEED          0000000000000420  00000420       0000000000000020  0000000000000000   A       4     1     8  [ 7] .rela.dyn         RELA             0000000000000440  00000440       00000000000000a8  0000000000000018   A       3     0     8  [ 8] .rela.plt         RELA             00000000000004e8  000004e8       0000000000000018  0000000000000018  AI       3    21     8  [ 9] .init             PROGBITS         0000000000000500  00000500       0000000000000017  0000000000000000  AX       0     0     4  [10] .plt              PROGBITS         0000000000000520  00000520       0000000000000020  0000000000000010  AX       0     0     16  [11] .plt.got          PROGBITS         0000000000000540  00000540       0000000000000008  0000000000000008  AX       0     0     8  [12] .text             PROGBITS         0000000000000550  00000550       000000000000010d  0000000000000000  AX       0     0     16  [13] .fini             PROGBITS         0000000000000660  00000660       0000000000000009  0000000000000000  AX       0     0     4  [14] .rodata           PROGBITS         0000000000000669  00000669       0000000000000008  0000000000000000   A       0     0     1  [15] .eh_frame_hdr     PROGBITS         0000000000000674  00000674       000000000000002c  0000000000000000   A       0     0     4  [16] .eh_frame         PROGBITS         00000000000006a0  000006a0       000000000000009c  0000000000000000   A       0     0     8  [17] .init_array       INIT_ARRAY       0000000000200e10  00000e10       0000000000000008  0000000000000008  WA       0     0     8  [18] .fini_array       FINI_ARRAY       0000000000200e18  00000e18       0000000000000008  0000000000000008  WA       0     0     8  [19] .dynamic          DYNAMIC          0000000000200e20  00000e20       00000000000001c0  0000000000000010  WA       4     0     8  [20] .got              PROGBITS         0000000000200fe0  00000fe0       0000000000000020  0000000000000008  WA       0     0     8  [21] .got.plt          PROGBITS         0000000000201000  00001000       0000000000000020  0000000000000008  WA       0     0     8  [22] .data             PROGBITS         0000000000201020  00001020       0000000000000008  0000000000000000  WA       0     0     8  [23] .bss              NOBITS           0000000000201028  00001028       0000000000000008  0000000000000000  WA       0     0     1  [24] .comment          PROGBITS         0000000000000000  00001028       0000000000000029  0000000000000001  MS       0     0     1  [25] .symtab           SYMTAB           0000000000000000  00001058       00000000000004b0  0000000000000018          26    38     8  [26] .strtab           STRTAB           0000000000000000  00001508       0000000000000186  0000000000000000           0     0     1  [27] .shstrtab         STRTAB           0000000000000000  0000168e       00000000000000f1  0000000000000000           0     0     1Key to Flags:  W (write), A (alloc), X (execute), M (merge), S (strings), I (info),  L (link order), O (extra OS processing required), G (group), T (TLS),  C (compressed), x (unknown), o (OS specific), E (exclude),  l (large), p (processor specific)There are no section groups in this file.Program Headers:  Type           Offset             VirtAddr           PhysAddr                 FileSiz            MemSiz              Flags  Align  LOAD           0x0000000000000000 0x0000000000000000 0x0000000000000000                 0x000000000000073c 0x000000000000073c  R E    0x200000  LOAD           0x0000000000000e10 0x0000000000200e10 0x0000000000200e10                 0x0000000000000218 0x0000000000000220  RW     0x200000  DYNAMIC        0x0000000000000e20 0x0000000000200e20 0x0000000000200e20                 0x00000000000001c0 0x00000000000001c0  RW     0x8  NOTE           0x00000000000001c8 0x00000000000001c8 0x00000000000001c8                 0x0000000000000024 0x0000000000000024  R      0x4  GNU_EH_FRAME   0x0000000000000674 0x0000000000000674 0x0000000000000674                 0x000000000000002c 0x000000000000002c  R      0x4  GNU_STACK      0x0000000000000000 0x0000000000000000 0x0000000000000000                 0x0000000000000000 0x0000000000000000  RW     0x10  GNU_RELRO      0x0000000000000e10 0x0000000000200e10 0x0000000000200e10                 0x00000000000001f0 0x00000000000001f0  R      0x1 Section to Segment mapping:  Segment Sections...   00     .note.gnu.build-id .gnu.hash .dynsym .dynstr .gnu.version .gnu.version_r .rela.dyn .rela.plt .init .plt .plt.got .text .fini .rodata .eh_frame_hdr .eh_frame    01     .init_array .fini_array .dynamic .got .got.plt .data .bss    02     .dynamic    03     .note.gnu.build-id    04     .eh_frame_hdr    05        06     .init_array .fini_array .dynamic .got Dynamic section at offset 0xe20 contains 24 entries:  Tag        Type                         Name/Value 0x0000000000000001 (NEEDED)             Shared library: [libc.so.6] 0x000000000000000c (INIT)               0x500 0x000000000000000d (FINI)               0x660 0x0000000000000019 (INIT_ARRAY)         0x200e10 0x000000000000001b (INIT_ARRAYSZ)       8 (bytes) 0x000000000000001a (FINI_ARRAY)         0x200e18 0x000000000000001c (FINI_ARRAYSZ)       8 (bytes) 0x000000006ffffef5 (GNU_HASH)           0x1f0 0x0000000000000005 (STRTAB)             0x368 0x0000000000000006 (SYMTAB)             0x230 0x000000000000000a (STRSZ)              157 (bytes) 0x000000000000000b (SYMENT)             24 (bytes) 0x0000000000000003 (PLTGOT)             0x201000 0x0000000000000002 (PLTRELSZ)           24 (bytes) 0x0000000000000014 (PLTREL)             RELA 0x0000000000000017 (JMPREL)             0x4e8 0x0000000000000007 (RELA)               0x440 0x0000000000000008 (RELASZ)             168 (bytes) 0x0000000000000009 (RELAENT)            24 (bytes) 0x000000006ffffffe (VERNEED)            0x420 0x000000006fffffff (VERNEEDNUM)         1 0x000000006ffffff0 (VERSYM)             0x406 0x000000006ffffff9 (RELACOUNT)          3 0x0000000000000000 (NULL)               0x0Relocation section &#x27;.rela.dyn&#x27; at offset 0x440 contains 7 entries:  Offset          Info           Type           Sym. Value    Sym. Name + Addend000000200e10  000000000008 R_X86_64_RELATIVE                    620000000200e18  000000000008 R_X86_64_RELATIVE                    5e0000000201020  000000000008 R_X86_64_RELATIVE                    201020000000200fe0  000100000006 R_X86_64_GLOB_DAT 0000000000000000 _ITM_deregisterTMClone + 0000000200fe8  000300000006 R_X86_64_GLOB_DAT 0000000000000000 __gmon_start__ + 0000000200ff0  000400000006 R_X86_64_GLOB_DAT 0000000000000000 _ITM_registerTMCloneTa + 0000000200ff8  000500000006 R_X86_64_GLOB_DAT 0000000000000000 __cxa_finalize@GLIBC_2.2.5 + 0Relocation section &#x27;.rela.plt&#x27; at offset 0x4e8 contains 1 entry:  Offset          Info           Type           Sym. Value    Sym. Name + Addend000000201018  000200000007 R_X86_64_JUMP_SLO 0000000000000000 puts@GLIBC_2.2.5 + 0The decoding of unwind sections for machine type Advanced Micro Devices X86-64 is not currently supported.Symbol table &#x27;.dynsym&#x27; contains 13 entries:   Num:    Value          Size Type    Bind   Vis      Ndx Name     0: 0000000000000000     0 NOTYPE  LOCAL  DEFAULT  UND      1: 0000000000000000     0 NOTYPE  WEAK   DEFAULT  UND _ITM_deregisterTMCloneTab     2: 0000000000000000     0 FUNC    GLOBAL DEFAULT  UND puts@GLIBC_2.2.5 (2)     3: 0000000000000000     0 NOTYPE  WEAK   DEFAULT  UND __gmon_start__     4: 0000000000000000     0 NOTYPE  WEAK   DEFAULT  UND _ITM_registerTMCloneTable     5: 0000000000000000     0 FUNC    WEAK   DEFAULT  UND __cxa_finalize@GLIBC_2.2.5 (2)     6: 0000000000201028     0 NOTYPE  GLOBAL DEFAULT   22 _edata     7: 0000000000201030     0 NOTYPE  GLOBAL DEFAULT   23 _end     8: 000000000000063d    32 FUNC    GLOBAL DEFAULT   12 add     9: 0000000000201028     0 NOTYPE  GLOBAL DEFAULT   23 __bss_start    10: 0000000000000500     0 FUNC    GLOBAL DEFAULT    9 _init    11: 0000000000000660     0 FUNC    GLOBAL DEFAULT   13 _fini    12: 000000000000062a    19 FUNC    GLOBAL DEFAULT   12 funcSymbol table &#x27;.symtab&#x27; contains 50 entries:   Num:    Value          Size Type    Bind   Vis      Ndx Name     0: 0000000000000000     0 NOTYPE  LOCAL  DEFAULT  UND      1: 0000000000000550     0 FUNC    LOCAL  DEFAULT   12 deregister_tm_clones     2: 0000000000000590     0 FUNC    LOCAL  DEFAULT   12 register_tm_clones     3: 00000000000005e0     0 FUNC    LOCAL  DEFAULT   12 __do_global_dtors_aux     4: 0000000000201028     1 OBJECT  LOCAL  DEFAULT   23 completed.7698     5: 0000000000200e18     0 OBJECT  LOCAL  DEFAULT   18 __do_global_dtors_aux_fin     6: 0000000000000620     0 FUNC    LOCAL  DEFAULT   12 frame_dummy     7: 0000000000200e10     0 OBJECT  LOCAL  DEFAULT   17 __frame_dummy_init_array_     8: 0000000000000738     0 OBJECT  LOCAL  DEFAULT   16 __FRAME_END__     9: 0000000000201020     0 OBJECT  LOCAL  DEFAULT   22 __dso_handle    10: 0000000000200e20     0 OBJECT  LOCAL  DEFAULT   19 _DYNAMIC    11: 0000000000000674     0 NOTYPE  LOCAL  DEFAULT   15 __GNU_EH_FRAME_HDR    12: 0000000000201028     0 OBJECT  LOCAL  DEFAULT   22 __TMC_END__    13: 0000000000201000     0 OBJECT  LOCAL  DEFAULT   21 _GLOBAL_OFFSET_TABLE_    14: 00000000000001c8     0 SECTION LOCAL  DEFAULT    1     15: 00000000000001f0     0 SECTION LOCAL  DEFAULT    2     16: 0000000000000230     0 SECTION LOCAL  DEFAULT    3     17: 0000000000000368     0 SECTION LOCAL  DEFAULT    4     18: 0000000000000406     0 SECTION LOCAL  DEFAULT    5     19: 0000000000000420     0 SECTION LOCAL  DEFAULT    6     20: 0000000000000440     0 SECTION LOCAL  DEFAULT    7     21: 00000000000004e8     0 SECTION LOCAL  DEFAULT    8     22: 0000000000000500     0 SECTION LOCAL  DEFAULT    9     23: 0000000000000520     0 SECTION LOCAL  DEFAULT   10     24: 0000000000000540     0 SECTION LOCAL  DEFAULT   11     25: 0000000000000550     0 SECTION LOCAL  DEFAULT   12     26: 0000000000000660     0 SECTION LOCAL  DEFAULT   13     27: 0000000000000669     0 SECTION LOCAL  DEFAULT   14     28: 0000000000000674     0 SECTION LOCAL  DEFAULT   15     29: 00000000000006a0     0 SECTION LOCAL  DEFAULT   16     30: 0000000000200e10     0 SECTION LOCAL  DEFAULT   17     31: 0000000000200e18     0 SECTION LOCAL  DEFAULT   18     32: 0000000000200e20     0 SECTION LOCAL  DEFAULT   19     33: 0000000000200fe0     0 SECTION LOCAL  DEFAULT   20     34: 0000000000201000     0 SECTION LOCAL  DEFAULT   21     35: 0000000000201020     0 SECTION LOCAL  DEFAULT   22     36: 0000000000201028     0 SECTION LOCAL  DEFAULT   23     37: 0000000000000000     0 SECTION LOCAL  DEFAULT   24     38: 0000000000000000     0 NOTYPE  WEAK   DEFAULT  UND _ITM_deregisterTMCloneTab    39: 000000000000063d    32 FUNC    GLOBAL DEFAULT   12 add    40: 0000000000000000     0 FUNC    GLOBAL DEFAULT  UND puts@@GLIBC_2.2.5    41: 0000000000201028     0 NOTYPE  GLOBAL DEFAULT   22 _edata    42: 0000000000000660     0 FUNC    GLOBAL DEFAULT   13 _fini    43: 0000000000000000     0 NOTYPE  WEAK   DEFAULT  UND __gmon_start__    44: 000000000000062a    19 FUNC    GLOBAL DEFAULT   12 func    45: 0000000000201030     0 NOTYPE  GLOBAL DEFAULT   23 _end    46: 0000000000201028     0 NOTYPE  GLOBAL DEFAULT   23 __bss_start    47: 0000000000000000     0 NOTYPE  WEAK   DEFAULT  UND _ITM_registerTMCloneTable    48: 0000000000000000     0 FUNC    WEAK   DEFAULT  UND __cxa_finalize@@GLIBC_2.2    49: 0000000000000500     0 FUNC    GLOBAL DEFAULT    9 _initHistogram for `.gnu.hash&#x27; bucket list length (total of 3 buckets): Length  Number     % of total  Coverage      0  0          (  0.0%)      1  0          (  0.0%)      0.0%      2  2          ( 66.7%)     57.1%      3  1          ( 33.3%)    100.0%Version symbols section &#x27;.gnu.version&#x27; contains 13 entries: Addr: 0000000000000406  Offset: 0x000406  Link: 3 (.dynsym)  000:   0 (*local*)       0 (*local*)       2 (GLIBC_2.2.5)   0 (*local*)      004:   0 (*local*)       2 (GLIBC_2.2.5)   1 (*global*)      1 (*global*)     008:   1 (*global*)      1 (*global*)      1 (*global*)      1 (*global*)     00c:   1 (*global*)   Version needs section &#x27;.gnu.version_r&#x27; contains 1 entry: Addr: 0x0000000000000420  Offset: 0x000420  Link: 4 (.dynstr)  000000: Version: 1  File: libc.so.6  Cnt: 1  0x0010:   Name: GLIBC_2.2.5  Flags: none  Version: 2Displaying notes found in: .note.gnu.build-id  Owner                 Data size\tDescription  GNU                  0x00000014\tNT_GNU_BUILD_ID (unique build ID bitstring)    Build ID: 3a6987a7f71f453637ab35daa89ec141fba9026b\n\n\n\n\n\n\n","slug":"cpp/strip","date":"2023-11-30T21:20:29.000Z","categories_index":"script","tags_index":"shell,so","author_index":"NoleHuan"},{"id":"6c7ebfa27e3441c41e8e3de672151141","title":"ptp","content":"","slug":"cpp/ptp","date":"2023-11-29T21:26:29.000Z","categories_index":"tool","tags_index":"time","author_index":"NoleHuan"},{"id":"ce97a94626317b127a6da02030ff4c21","title":"shell","content":"lsrmdups\nps -aux\n\n12345$ ps -auxUSER       PID %CPU %MEM    VSZ   RSS TTY      STAT START   TIME COMMANDroot         1  0.2  0.1 225748  9368 ?        Ss   21:28   0:01 /sbin/init splashroot         2  0.0  0.0      0     0 ?        S    21:28   0:00 [kthreadd]root         3  0.0  0.0      0     0 ?        I&lt;   21:28   0:00 [rcu_gp]\na 显示终端上的所有进程u 显示进程用户x 显示所有终端的进程\n\nps -elf\n\n12345$ ps -elfF S UID        PID  PPID  C PRI  NI ADDR SZ WCHAN  STIME TTY          TIME CMD4 S root         1     0  0  80   0 - 56437 -      21:28 ?        00:00:02 /sbin/init splash1 S root         2     0  0  80   0 -     0 -      21:28 ?        00:00:00 [kthreadd]1 I root         3     2  0  60 -20 -     0 -      21:28 ?        00:00:00 [rcu_gp]\ne 显示系统内的所有进程信息l 使用长格式显示进程信息f 使用完整格式显示进程信息\npidof查找指定进程名的进程 PID12345$ ps -elf | grep hexo0 S nolehuan  3670  3581  0  80   0 - 243195 ep_pol 21:41 pts/1   00:00:02 hexo0 S nolehuan  4297  3502  0  80   0 -  4221 pipe_w 21:52 pts/0    00:00:00 grep --color=auto hexo$ pidof hexo3670\nfind\nfind -name &#39;*.sh&#39; 查找当前目录及子目录下 sh 结尾的文件\n\nkillkill -9 pid\nmkdirlntailtartoprsyncreadelfelf 文件\n\n可执行文件 .out\n共享目标文件 .a\n可重定位文件 .so\n\n参数-a 显示全部信息-h 显示文件头信息 ELF Header-l 显示程序头信息 Program Headers-S 显示节头信息 Section Headers-g 显示节组信息-s 显示符号表段中的项 Symbol table-n 显示内核注释信息-r 显示可重定位段的信息 Relocation section-d 显示动态段信息 Dynamic section-V 显示版本段信息\n\ndetails\n\n123456789101112131415161718192021222324252627282930313233343536373839404142434445464748495051525354555657585960616263646566676869707172737475767778798081828384858687888990919293949596979899100101102103104105106107108109110111112113114115116117118119120121122123124125126127128129130131132133134135136137138139140141142143144145146147148149150151152153154155156157158159160161162163164165166167168169170171172173174175176177178179180181182183184185186187188189190191192193194195196197198199200201202203204205206207208209210211212213214215216217218219220221222223224225226227228229230231232233234235236237238239240241242243244245246247248249250251252253254255256257258259260261262263264265266267268269270271$ readelf -a libtest.soELF Header:  Magic:   7f 45 4c 46 02 01 01 00 00 00 00 00 00 00 00 00   Class:                             ELF64  Data:                              2&#x27;s complement, little endian  Version:                           1 (current)  OS/ABI:                            UNIX - System V  ABI Version:                       0  Type:                              DYN (Shared object file)  Machine:                           Advanced Micro Devices X86-64  Version:                           0x1  Entry point address:               0x550  Start of program headers:          64 (bytes into file)  Start of section headers:          8368 (bytes into file)  Flags:                             0x0  Size of this header:               64 (bytes)  Size of program headers:           56 (bytes)  Number of program headers:         7  Size of section headers:           64 (bytes)  Number of section headers:         33  Section header string table index: 32Section Headers:  [Nr] Name              Type             Address           Offset       Size              EntSize          Flags  Link  Info  Align  [ 0]                   NULL             0000000000000000  00000000       0000000000000000  0000000000000000           0     0     0  [ 1] .note.gnu.build-i NOTE             00000000000001c8  000001c8       0000000000000024  0000000000000000   A       0     0     4  [ 2] .gnu.hash         GNU_HASH         00000000000001f0  000001f0       0000000000000040  0000000000000000   A       3     0     8  [ 3] .dynsym           DYNSYM           0000000000000230  00000230       0000000000000138  0000000000000018   A       4     1     8  [ 4] .dynstr           STRTAB           0000000000000368  00000368       000000000000009d  0000000000000000   A       0     0     1  [ 5] .gnu.version      VERSYM           0000000000000406  00000406       000000000000001a  0000000000000002   A       3     0     2  [ 6] .gnu.version_r    VERNEED          0000000000000420  00000420       0000000000000020  0000000000000000   A       4     1     8  [ 7] .rela.dyn         RELA             0000000000000440  00000440       00000000000000a8  0000000000000018   A       3     0     8  [ 8] .rela.plt         RELA             00000000000004e8  000004e8       0000000000000018  0000000000000018  AI       3    21     8  [ 9] .init             PROGBITS         0000000000000500  00000500       0000000000000017  0000000000000000  AX       0     0     4  [10] .plt              PROGBITS         0000000000000520  00000520       0000000000000020  0000000000000010  AX       0     0     16  [11] .plt.got          PROGBITS         0000000000000540  00000540       0000000000000008  0000000000000008  AX       0     0     8  [12] .text             PROGBITS         0000000000000550  00000550       000000000000010d  0000000000000000  AX       0     0     16  [13] .fini             PROGBITS         0000000000000660  00000660       0000000000000009  0000000000000000  AX       0     0     4  [14] .rodata           PROGBITS         0000000000000669  00000669       0000000000000008  0000000000000000   A       0     0     1  [15] .eh_frame_hdr     PROGBITS         0000000000000674  00000674       000000000000002c  0000000000000000   A       0     0     4  [16] .eh_frame         PROGBITS         00000000000006a0  000006a0       000000000000009c  0000000000000000   A       0     0     8  [17] .init_array       INIT_ARRAY       0000000000200e10  00000e10       0000000000000008  0000000000000008  WA       0     0     8  [18] .fini_array       FINI_ARRAY       0000000000200e18  00000e18       0000000000000008  0000000000000008  WA       0     0     8  [19] .dynamic          DYNAMIC          0000000000200e20  00000e20       00000000000001c0  0000000000000010  WA       4     0     8  [20] .got              PROGBITS         0000000000200fe0  00000fe0       0000000000000020  0000000000000008  WA       0     0     8  [21] .got.plt          PROGBITS         0000000000201000  00001000       0000000000000020  0000000000000008  WA       0     0     8  [22] .data             PROGBITS         0000000000201020  00001020       0000000000000008  0000000000000000  WA       0     0     8  [23] .bss              NOBITS           0000000000201028  00001028       0000000000000008  0000000000000000  WA       0     0     1  [24] .comment          PROGBITS         0000000000000000  00001028       0000000000000029  0000000000000001  MS       0     0     1  [25] .debug_aranges    PROGBITS         0000000000000000  00001051       0000000000000030  0000000000000000           0     0     1  [26] .debug_info       PROGBITS         0000000000000000  00001081       000000000000035b  0000000000000000           0     0     1  [27] .debug_abbrev     PROGBITS         0000000000000000  000013dc       0000000000000109  0000000000000000           0     0     1  [28] .debug_line       PROGBITS         0000000000000000  000014e5       00000000000000d7  0000000000000000           0     0     1  [29] .debug_str        PROGBITS         0000000000000000  000015bc       0000000000000296  0000000000000001  MS       0     0     1  [30] .symtab           SYMTAB           0000000000000000  00001858       0000000000000588  0000000000000018          31    47     8  [31] .strtab           STRTAB           0000000000000000  00001de0       000000000000019b  0000000000000000           0     0     1  [32] .shstrtab         STRTAB           0000000000000000  00001f7b       0000000000000131  0000000000000000           0     0     1Key to Flags:  W (write), A (alloc), X (execute), M (merge), S (strings), I (info),  L (link order), O (extra OS processing required), G (group), T (TLS),  C (compressed), x (unknown), o (OS specific), E (exclude),  l (large), p (processor specific)There are no section groups in this file.Program Headers:  Type           Offset             VirtAddr           PhysAddr                 FileSiz            MemSiz              Flags  Align  LOAD           0x0000000000000000 0x0000000000000000 0x0000000000000000                 0x000000000000073c 0x000000000000073c  R E    0x200000  LOAD           0x0000000000000e10 0x0000000000200e10 0x0000000000200e10                 0x0000000000000218 0x0000000000000220  RW     0x200000  DYNAMIC        0x0000000000000e20 0x0000000000200e20 0x0000000000200e20                 0x00000000000001c0 0x00000000000001c0  RW     0x8  NOTE           0x00000000000001c8 0x00000000000001c8 0x00000000000001c8                 0x0000000000000024 0x0000000000000024  R      0x4  GNU_EH_FRAME   0x0000000000000674 0x0000000000000674 0x0000000000000674                 0x000000000000002c 0x000000000000002c  R      0x4  GNU_STACK      0x0000000000000000 0x0000000000000000 0x0000000000000000                 0x0000000000000000 0x0000000000000000  RW     0x10  GNU_RELRO      0x0000000000000e10 0x0000000000200e10 0x0000000000200e10                 0x00000000000001f0 0x00000000000001f0  R      0x1 Section to Segment mapping:  Segment Sections...   00     .note.gnu.build-id .gnu.hash .dynsym .dynstr .gnu.version .gnu.version_r .rela.dyn .rela.plt .init .plt .plt.got .text .fini .rodata .eh_frame_hdr .eh_frame    01     .init_array .fini_array .dynamic .got .got.plt .data .bss    02     .dynamic    03     .note.gnu.build-id    04     .eh_frame_hdr    05        06     .init_array .fini_array .dynamic .got Dynamic section at offset 0xe20 contains 24 entries:  Tag        Type                         Name/Value 0x0000000000000001 (NEEDED)             Shared library: [libc.so.6] 0x000000000000000c (INIT)               0x500 0x000000000000000d (FINI)               0x660 0x0000000000000019 (INIT_ARRAY)         0x200e10 0x000000000000001b (INIT_ARRAYSZ)       8 (bytes) 0x000000000000001a (FINI_ARRAY)         0x200e18 0x000000000000001c (FINI_ARRAYSZ)       8 (bytes) 0x000000006ffffef5 (GNU_HASH)           0x1f0 0x0000000000000005 (STRTAB)             0x368 0x0000000000000006 (SYMTAB)             0x230 0x000000000000000a (STRSZ)              157 (bytes) 0x000000000000000b (SYMENT)             24 (bytes) 0x0000000000000003 (PLTGOT)             0x201000 0x0000000000000002 (PLTRELSZ)           24 (bytes) 0x0000000000000014 (PLTREL)             RELA 0x0000000000000017 (JMPREL)             0x4e8 0x0000000000000007 (RELA)               0x440 0x0000000000000008 (RELASZ)             168 (bytes) 0x0000000000000009 (RELAENT)            24 (bytes) 0x000000006ffffffe (VERNEED)            0x420 0x000000006fffffff (VERNEEDNUM)         1 0x000000006ffffff0 (VERSYM)             0x406 0x000000006ffffff9 (RELACOUNT)          3 0x0000000000000000 (NULL)               0x0Relocation section &#x27;.rela.dyn&#x27; at offset 0x440 contains 7 entries:  Offset          Info           Type           Sym. Value    Sym. Name + Addend000000200e10  000000000008 R_X86_64_RELATIVE                    620000000200e18  000000000008 R_X86_64_RELATIVE                    5e0000000201020  000000000008 R_X86_64_RELATIVE                    201020000000200fe0  000100000006 R_X86_64_GLOB_DAT 0000000000000000 _ITM_deregisterTMClone + 0000000200fe8  000300000006 R_X86_64_GLOB_DAT 0000000000000000 __gmon_start__ + 0000000200ff0  000400000006 R_X86_64_GLOB_DAT 0000000000000000 _ITM_registerTMCloneTa + 0000000200ff8  000500000006 R_X86_64_GLOB_DAT 0000000000000000 __cxa_finalize@GLIBC_2.2.5 + 0Relocation section &#x27;.rela.plt&#x27; at offset 0x4e8 contains 1 entry:  Offset          Info           Type           Sym. Value    Sym. Name + Addend000000201018  000200000007 R_X86_64_JUMP_SLO 0000000000000000 puts@GLIBC_2.2.5 + 0The decoding of unwind sections for machine type Advanced Micro Devices X86-64 is not currently supported.Symbol table &#x27;.dynsym&#x27; contains 13 entries:   Num:    Value          Size Type    Bind   Vis      Ndx Name     0: 0000000000000000     0 NOTYPE  LOCAL  DEFAULT  UND      1: 0000000000000000     0 NOTYPE  WEAK   DEFAULT  UND _ITM_deregisterTMCloneTab     2: 0000000000000000     0 FUNC    GLOBAL DEFAULT  UND puts@GLIBC_2.2.5 (2)     3: 0000000000000000     0 NOTYPE  WEAK   DEFAULT  UND __gmon_start__     4: 0000000000000000     0 NOTYPE  WEAK   DEFAULT  UND _ITM_registerTMCloneTable     5: 0000000000000000     0 FUNC    WEAK   DEFAULT  UND __cxa_finalize@GLIBC_2.2.5 (2)     6: 0000000000201028     0 NOTYPE  GLOBAL DEFAULT   22 _edata     7: 0000000000201030     0 NOTYPE  GLOBAL DEFAULT   23 _end     8: 000000000000063d    32 FUNC    GLOBAL DEFAULT   12 add     9: 0000000000201028     0 NOTYPE  GLOBAL DEFAULT   23 __bss_start    10: 0000000000000500     0 FUNC    GLOBAL DEFAULT    9 _init    11: 0000000000000660     0 FUNC    GLOBAL DEFAULT   13 _fini    12: 000000000000062a    19 FUNC    GLOBAL DEFAULT   12 funcSymbol table &#x27;.symtab&#x27; contains 59 entries:   Num:    Value          Size Type    Bind   Vis      Ndx Name     0: 0000000000000000     0 NOTYPE  LOCAL  DEFAULT  UND      1: 00000000000001c8     0 SECTION LOCAL  DEFAULT    1      2: 00000000000001f0     0 SECTION LOCAL  DEFAULT    2      3: 0000000000000230     0 SECTION LOCAL  DEFAULT    3      4: 0000000000000368     0 SECTION LOCAL  DEFAULT    4      5: 0000000000000406     0 SECTION LOCAL  DEFAULT    5      6: 0000000000000420     0 SECTION LOCAL  DEFAULT    6      7: 0000000000000440     0 SECTION LOCAL  DEFAULT    7      8: 00000000000004e8     0 SECTION LOCAL  DEFAULT    8      9: 0000000000000500     0 SECTION LOCAL  DEFAULT    9     10: 0000000000000520     0 SECTION LOCAL  DEFAULT   10     11: 0000000000000540     0 SECTION LOCAL  DEFAULT   11     12: 0000000000000550     0 SECTION LOCAL  DEFAULT   12     13: 0000000000000660     0 SECTION LOCAL  DEFAULT   13     14: 0000000000000669     0 SECTION LOCAL  DEFAULT   14     15: 0000000000000674     0 SECTION LOCAL  DEFAULT   15     16: 00000000000006a0     0 SECTION LOCAL  DEFAULT   16     17: 0000000000200e10     0 SECTION LOCAL  DEFAULT   17     18: 0000000000200e18     0 SECTION LOCAL  DEFAULT   18     19: 0000000000200e20     0 SECTION LOCAL  DEFAULT   19     20: 0000000000200fe0     0 SECTION LOCAL  DEFAULT   20     21: 0000000000201000     0 SECTION LOCAL  DEFAULT   21     22: 0000000000201020     0 SECTION LOCAL  DEFAULT   22     23: 0000000000201028     0 SECTION LOCAL  DEFAULT   23     24: 0000000000000000     0 SECTION LOCAL  DEFAULT   24     25: 0000000000000000     0 SECTION LOCAL  DEFAULT   25     26: 0000000000000000     0 SECTION LOCAL  DEFAULT   26     27: 0000000000000000     0 SECTION LOCAL  DEFAULT   27     28: 0000000000000000     0 SECTION LOCAL  DEFAULT   28     29: 0000000000000000     0 SECTION LOCAL  DEFAULT   29     30: 0000000000000000     0 FILE    LOCAL  DEFAULT  ABS crtstuff.c    31: 0000000000000550     0 FUNC    LOCAL  DEFAULT   12 deregister_tm_clones    32: 0000000000000590     0 FUNC    LOCAL  DEFAULT   12 register_tm_clones    33: 00000000000005e0     0 FUNC    LOCAL  DEFAULT   12 __do_global_dtors_aux    34: 0000000000201028     1 OBJECT  LOCAL  DEFAULT   23 completed.7698    35: 0000000000200e18     0 OBJECT  LOCAL  DEFAULT   18 __do_global_dtors_aux_fin    36: 0000000000000620     0 FUNC    LOCAL  DEFAULT   12 frame_dummy    37: 0000000000200e10     0 OBJECT  LOCAL  DEFAULT   17 __frame_dummy_init_array_    38: 0000000000000000     0 FILE    LOCAL  DEFAULT  ABS libtest.c    39: 0000000000000000     0 FILE    LOCAL  DEFAULT  ABS crtstuff.c    40: 0000000000000738     0 OBJECT  LOCAL  DEFAULT   16 __FRAME_END__    41: 0000000000000000     0 FILE    LOCAL  DEFAULT  ABS     42: 0000000000201020     0 OBJECT  LOCAL  DEFAULT   22 __dso_handle    43: 0000000000200e20     0 OBJECT  LOCAL  DEFAULT   19 _DYNAMIC    44: 0000000000000674     0 NOTYPE  LOCAL  DEFAULT   15 __GNU_EH_FRAME_HDR    45: 0000000000201028     0 OBJECT  LOCAL  DEFAULT   22 __TMC_END__    46: 0000000000201000     0 OBJECT  LOCAL  DEFAULT   21 _GLOBAL_OFFSET_TABLE_    47: 0000000000000000     0 NOTYPE  WEAK   DEFAULT  UND _ITM_deregisterTMCloneTab    48: 000000000000063d    32 FUNC    GLOBAL DEFAULT   12 add    49: 0000000000000000     0 FUNC    GLOBAL DEFAULT  UND puts@@GLIBC_2.2.5    50: 0000000000201028     0 NOTYPE  GLOBAL DEFAULT   22 _edata    51: 0000000000000660     0 FUNC    GLOBAL DEFAULT   13 _fini    52: 0000000000000000     0 NOTYPE  WEAK   DEFAULT  UND __gmon_start__    53: 000000000000062a    19 FUNC    GLOBAL DEFAULT   12 func    54: 0000000000201030     0 NOTYPE  GLOBAL DEFAULT   23 _end    55: 0000000000201028     0 NOTYPE  GLOBAL DEFAULT   23 __bss_start    56: 0000000000000000     0 NOTYPE  WEAK   DEFAULT  UND _ITM_registerTMCloneTable    57: 0000000000000000     0 FUNC    WEAK   DEFAULT  UND __cxa_finalize@@GLIBC_2.2    58: 0000000000000500     0 FUNC    GLOBAL DEFAULT    9 _initHistogram for `.gnu.hash&#x27; bucket list length (total of 3 buckets): Length  Number     % of total  Coverage      0  0          (  0.0%)      1  0          (  0.0%)      0.0%      2  2          ( 66.7%)     57.1%      3  1          ( 33.3%)    100.0%Version symbols section &#x27;.gnu.version&#x27; contains 13 entries: Addr: 0000000000000406  Offset: 0x000406  Link: 3 (.dynsym)  000:   0 (*local*)       0 (*local*)       2 (GLIBC_2.2.5)   0 (*local*)      004:   0 (*local*)       2 (GLIBC_2.2.5)   1 (*global*)      1 (*global*)     008:   1 (*global*)      1 (*global*)      1 (*global*)      1 (*global*)     00c:   1 (*global*)   Version needs section &#x27;.gnu.version_r&#x27; contains 1 entry: Addr: 0x0000000000000420  Offset: 0x000420  Link: 4 (.dynstr)  000000: Version: 1  File: libc.so.6  Cnt: 1  0x0010:   Name: GLIBC_2.2.5  Flags: none  Version: 2Displaying notes found in: .note.gnu.build-id  Owner                 Data size\tDescription  GNU                  0x00000014\tNT_GNU_BUILD_ID (unique build ID bitstring)    Build ID: 3a6987a7f71f453637ab35daa89ec141fba9026b\n\n\nobjdumpddgrepsedawkperfethtooliperfiftoptee","slug":"cpp/shell","date":"2023-11-28T21:30:29.000Z","categories_index":"script","tags_index":"shell","author_index":"NoleHuan"},{"id":"764bdd9ac479a79e4d1149181d7f0f7f","title":"asm","content":"lea 与 mov 的区别\nlea load effective address\n\n可以用来将一个内存地址直接赋给目的操作数，如 lea eax, [ebx+8] 将值 ebx+8 直接赋给 eax，而不是把内存地址 ebx+8 处的数据赋给 eax\n\nmov\n\nmov eax, [ebx+8] 将内存地址 ebx+8 处的数据赋给 eax\n参考https://www.zhihu.com/question/40720890/answer/110774673\n","slug":"cpp/asm","date":"2023-11-27T21:30:29.000Z","categories_index":"coding","tags_index":"asm","author_index":"NoleHuan"},{"id":"dbb86e8f6a01395cf52e4238dc8be85a","title":"so","content":"使用 mv 与 cp 命令更新运行中的动态链接库是否会发生问题？cp 命令更新运行中的动态链接库会导致程序 core 掉？\nLinux 文件系统Linux 文件系统中，每个文件对应一个 inode 与 dentry\ninode硬盘分为两个区域：数据区与 inode table，inode 存储文件元信息，可以用 stat 命令查看\n123456789$ stat test.cpp   File: test.cpp  Size: 458       \tBlocks: 8          IO Block: 4096   regular fileDevice: 10307h/66311d\tInode: 535078      Links: 1Access: (0664/-rw-rw-r--)  Uid: ( 1000/nolehuan)   Gid: ( 1000/nolehuan)Access: 2023-11-04 15:20:56.725957003 +0800Modify: 2022-11-24 22:25:10.659748611 +0800Change: 2022-11-24 22:25:10.659748611 +0800 Birth: -\nLinks: 1 记录硬链接计数，硬链接仅文件名不同，inode 号相同；软链接文件数据块中存放对应文件的路径\nls -i 命令查看文件 inode 编号12$ ls -i test.cpp 535078 test.cpp\ndentrydirectory entry 记录文件的目录信息与 inode 指针，存在于内存中\n程序运行时，进程 pcb 中保存一份文件描述符表，文件描述符对应进程已打开文件的 file 结构体，file 结构体中包括文件打开时的标志位、引用计数和 dentry 指针等信息，通过 dentry 指针找到文件对应 inode 进而操作文件\ncp mv rm 原理执行 cp 命令时 inode 号分配规则\n\n目标文件存在则 inode 保持文件覆盖前的编号\n目标文件不存在则分配一个未使用的 inode 号，并添加至 inode table\n\n123456$ touch a b &amp;&amp; ls -i a b548015 a  560350 b$ cp a b &amp;&amp; ls -i a b548015 a  560350 b$ cp b c &amp;&amp; ls -i b c560350 b  584072 c\n执行 mv 命令时，所在文件系统相同则保持源文件 inode 号123456$ touch a b &amp;&amp; ls -i a b583955 a  584095 b$ mv a b &amp;&amp; ls -i b583955 b$ mv b c &amp;&amp; ls -i c583955 c\ncp 命令执行步骤\n\ninode 号分配\n新建 dentry 并指向 inode\n复制数据至 block 中\n\nrm 命令执行步骤\n\n递减硬链接计数，计数归零时释放 inode 号\n将数据块挂至空闲链表\n删除目录映射表中的相关行\n\nmv 命令执行步骤\n\n源文件与目标文件所在文件系统相同：新建 dentry，删除原 dentry，对 inode 无影响，不移动数据\n源文件与目标文件所在文件系统不同：cp + rm\n\nstrace 命令跟踪 cp 执行过程1234567891011121314151617$ cat afile a$ cat bfile b$ strace cp a b...openat(AT_FDCWD, &quot;a&quot;, O_RDONLY)         = 3fstat(3, &#123;st_mode=S_IFREG|0664, st_size=7, ...&#125;) = 0openat(AT_FDCWD, &quot;b&quot;, O_WRONLY|O_TRUNC) = 4fstat(4, &#123;st_mode=S_IFREG|0664, st_size=0, ...&#125;) = 0...read(3, &quot;file a\\n&quot;, 131072)             = 7write(4, &quot;file a\\n&quot;, 7)                 = 7read(3, &quot;&quot;, 131072)                     = 0close(4)                                = 0close(3)                                = 0...\n\ndetails\n\n123456789101112131415161718192021222324252627282930313233343536373839404142434445464748495051525354555657585960616263646566676869707172737475767778798081828384858687888990919293949596979899100101102103104105106107108109110111112113114115116117118119120121122123124125126127128129130131132133134135136137138139140141142143144145146$ strace cp a bexecve(&quot;/bin/cp&quot;, [&quot;cp&quot;, &quot;a&quot;, &quot;b&quot;], 0x7ffccded9d50 /* 78 vars */) = 0brk(NULL)                               = 0x55a404a95000access(&quot;/etc/ld.so.nohwcap&quot;, F_OK)      = -1 ENOENT (No such file or directory)access(&quot;/etc/ld.so.preload&quot;, R_OK)      = -1 ENOENT (No such file or directory)openat(AT_FDCWD, &quot;/opt/ros/melodic/lib/tls/haswell/x86_64/libselinux.so.1&quot;, O_RDONLY|O_CLOEXEC) = -1 ENOENT (No such file or directory)stat(&quot;/opt/ros/melodic/lib/tls/haswell/x86_64&quot;, 0x7ffcc58a7250) = -1 ENOENT (No such file or directory)openat(AT_FDCWD, &quot;/opt/ros/melodic/lib/tls/haswell/libselinux.so.1&quot;, O_RDONLY|O_CLOEXEC) = -1 ENOENT (No such file or directory)stat(&quot;/opt/ros/melodic/lib/tls/haswell&quot;, 0x7ffcc58a7250) = -1 ENOENT (No such file or directory)openat(AT_FDCWD, &quot;/opt/ros/melodic/lib/tls/x86_64/libselinux.so.1&quot;, O_RDONLY|O_CLOEXEC) = -1 ENOENT (No such file or directory)stat(&quot;/opt/ros/melodic/lib/tls/x86_64&quot;, 0x7ffcc58a7250) = -1 ENOENT (No such file or directory)openat(AT_FDCWD, &quot;/opt/ros/melodic/lib/tls/libselinux.so.1&quot;, O_RDONLY|O_CLOEXEC) = -1 ENOENT (No such file or directory)stat(&quot;/opt/ros/melodic/lib/tls&quot;, 0x7ffcc58a7250) = -1 ENOENT (No such file or directory)openat(AT_FDCWD, &quot;/opt/ros/melodic/lib/haswell/x86_64/libselinux.so.1&quot;, O_RDONLY|O_CLOEXEC) = -1 ENOENT (No such file or directory)stat(&quot;/opt/ros/melodic/lib/haswell/x86_64&quot;, 0x7ffcc58a7250) = -1 ENOENT (No such file or directory)openat(AT_FDCWD, &quot;/opt/ros/melodic/lib/haswell/libselinux.so.1&quot;, O_RDONLY|O_CLOEXEC) = -1 ENOENT (No such file or directory)stat(&quot;/opt/ros/melodic/lib/haswell&quot;, 0x7ffcc58a7250) = -1 ENOENT (No such file or directory)openat(AT_FDCWD, &quot;/opt/ros/melodic/lib/x86_64/libselinux.so.1&quot;, O_RDONLY|O_CLOEXEC) = -1 ENOENT (No such file or directory)stat(&quot;/opt/ros/melodic/lib/x86_64&quot;, 0x7ffcc58a7250) = -1 ENOENT (No such file or directory)openat(AT_FDCWD, &quot;/opt/ros/melodic/lib/libselinux.so.1&quot;, O_RDONLY|O_CLOEXEC) = -1 ENOENT (No such file or directory)stat(&quot;/opt/ros/melodic/lib&quot;, &#123;st_mode=S_IFDIR|0755, st_size=36864, ...&#125;) = 0openat(AT_FDCWD, &quot;/etc/ld.so.cache&quot;, O_RDONLY|O_CLOEXEC) = 3fstat(3, &#123;st_mode=S_IFREG|0644, st_size=223218, ...&#125;) = 0mmap(NULL, 223218, PROT_READ, MAP_PRIVATE, 3, 0) = 0x7f89809af000close(3)                                = 0access(&quot;/etc/ld.so.nohwcap&quot;, F_OK)      = -1 ENOENT (No such file or directory)openat(AT_FDCWD, &quot;/lib/x86_64-linux-gnu/libselinux.so.1&quot;, O_RDONLY|O_CLOEXEC) = 3read(3, &quot;\\177ELF\\2\\1\\1\\0\\0\\0\\0\\0\\0\\0\\0\\0\\3\\0&gt;\\0\\1\\0\\0\\0\\20b\\0\\0\\0\\0\\0\\0&quot;..., 832) = 832fstat(3, &#123;st_mode=S_IFREG|0644, st_size=154832, ...&#125;) = 0mmap(NULL, 8192, PROT_READ|PROT_WRITE, MAP_PRIVATE|MAP_ANONYMOUS, -1, 0) = 0x7f89809ad000mmap(NULL, 2259152, PROT_READ|PROT_EXEC, MAP_PRIVATE|MAP_DENYWRITE, 3, 0) = 0x7f8980595000mprotect(0x7f89805ba000, 2093056, PROT_NONE) = 0mmap(0x7f89807b9000, 8192, PROT_READ|PROT_WRITE, MAP_PRIVATE|MAP_FIXED|MAP_DENYWRITE, 3, 0x24000) = 0x7f89807b9000mmap(0x7f89807bb000, 6352, PROT_READ|PROT_WRITE, MAP_PRIVATE|MAP_FIXED|MAP_ANONYMOUS, -1, 0) = 0x7f89807bb000close(3)                                = 0openat(AT_FDCWD, &quot;/opt/ros/melodic/lib/libacl.so.1&quot;, O_RDONLY|O_CLOEXEC) = -1 ENOENT (No such file or directory)access(&quot;/etc/ld.so.nohwcap&quot;, F_OK)      = -1 ENOENT (No such file or directory)openat(AT_FDCWD, &quot;/lib/x86_64-linux-gnu/libacl.so.1&quot;, O_RDONLY|O_CLOEXEC) = 3read(3, &quot;\\177ELF\\2\\1\\1\\0\\0\\0\\0\\0\\0\\0\\0\\0\\3\\0&gt;\\0\\1\\0\\0\\0\\340\\33\\0\\0\\0\\0\\0\\0&quot;..., 832) = 832fstat(3, &#123;st_mode=S_IFREG|0644, st_size=31232, ...&#125;) = 0mmap(NULL, 2126336, PROT_READ|PROT_EXEC, MAP_PRIVATE|MAP_DENYWRITE, 3, 0) = 0x7f898038d000mprotect(0x7f8980394000, 2093056, PROT_NONE) = 0mmap(0x7f8980593000, 8192, PROT_READ|PROT_WRITE, MAP_PRIVATE|MAP_FIXED|MAP_DENYWRITE, 3, 0x6000) = 0x7f8980593000close(3)                                = 0openat(AT_FDCWD, &quot;/opt/ros/melodic/lib/libattr.so.1&quot;, O_RDONLY|O_CLOEXEC) = -1 ENOENT (No such file or directory)access(&quot;/etc/ld.so.nohwcap&quot;, F_OK)      = -1 ENOENT (No such file or directory)openat(AT_FDCWD, &quot;/lib/x86_64-linux-gnu/libattr.so.1&quot;, O_RDONLY|O_CLOEXEC) = 3read(3, &quot;\\177ELF\\2\\1\\1\\0\\0\\0\\0\\0\\0\\0\\0\\0\\3\\0&gt;\\0\\1\\0\\0\\0\\260\\20\\0\\0\\0\\0\\0\\0&quot;..., 832) = 832fstat(3, &#123;st_mode=S_IFREG|0644, st_size=18680, ...&#125;) = 0mmap(NULL, 2113752, PROT_READ|PROT_EXEC, MAP_PRIVATE|MAP_DENYWRITE, 3, 0) = 0x7f8980188000mprotect(0x7f898018c000, 2093056, PROT_NONE) = 0mmap(0x7f898038b000, 8192, PROT_READ|PROT_WRITE, MAP_PRIVATE|MAP_FIXED|MAP_DENYWRITE, 3, 0x3000) = 0x7f898038b000close(3)                                = 0openat(AT_FDCWD, &quot;/opt/ros/melodic/lib/libc.so.6&quot;, O_RDONLY|O_CLOEXEC) = -1 ENOENT (No such file or directory)access(&quot;/etc/ld.so.nohwcap&quot;, F_OK)      = -1 ENOENT (No such file or directory)openat(AT_FDCWD, &quot;/lib/x86_64-linux-gnu/libc.so.6&quot;, O_RDONLY|O_CLOEXEC) = 3read(3, &quot;\\177ELF\\2\\1\\1\\3\\0\\0\\0\\0\\0\\0\\0\\0\\3\\0&gt;\\0\\1\\0\\0\\0\\240\\35\\2\\0\\0\\0\\0\\0&quot;..., 832) = 832fstat(3, &#123;st_mode=S_IFREG|0755, st_size=2030928, ...&#125;) = 0mmap(NULL, 4131552, PROT_READ|PROT_EXEC, MAP_PRIVATE|MAP_DENYWRITE, 3, 0) = 0x7f897fd97000mprotect(0x7f897ff7e000, 2097152, PROT_NONE) = 0mmap(0x7f898017e000, 24576, PROT_READ|PROT_WRITE, MAP_PRIVATE|MAP_FIXED|MAP_DENYWRITE, 3, 0x1e7000) = 0x7f898017e000mmap(0x7f8980184000, 15072, PROT_READ|PROT_WRITE, MAP_PRIVATE|MAP_FIXED|MAP_ANONYMOUS, -1, 0) = 0x7f8980184000close(3)                                = 0openat(AT_FDCWD, &quot;/opt/ros/melodic/lib/libpcre.so.3&quot;, O_RDONLY|O_CLOEXEC) = -1 ENOENT (No such file or directory)access(&quot;/etc/ld.so.nohwcap&quot;, F_OK)      = -1 ENOENT (No such file or directory)openat(AT_FDCWD, &quot;/lib/x86_64-linux-gnu/libpcre.so.3&quot;, O_RDONLY|O_CLOEXEC) = 3read(3, &quot;\\177ELF\\2\\1\\1\\0\\0\\0\\0\\0\\0\\0\\0\\0\\3\\0&gt;\\0\\1\\0\\0\\0 \\25\\0\\0\\0\\0\\0\\0&quot;..., 832) = 832fstat(3, &#123;st_mode=S_IFREG|0644, st_size=460728, ...&#125;) = 0mmap(NULL, 2556168, PROT_READ|PROT_EXEC, MAP_PRIVATE|MAP_DENYWRITE, 3, 0) = 0x7f897fb26000mprotect(0x7f897fb96000, 2093056, PROT_NONE) = 0mmap(0x7f897fd95000, 8192, PROT_READ|PROT_WRITE, MAP_PRIVATE|MAP_FIXED|MAP_DENYWRITE, 3, 0x6f000) = 0x7f897fd95000close(3)                                = 0openat(AT_FDCWD, &quot;/opt/ros/melodic/lib/libdl.so.2&quot;, O_RDONLY|O_CLOEXEC) = -1 ENOENT (No such file or directory)access(&quot;/etc/ld.so.nohwcap&quot;, F_OK)      = -1 ENOENT (No such file or directory)openat(AT_FDCWD, &quot;/lib/x86_64-linux-gnu/libdl.so.2&quot;, O_RDONLY|O_CLOEXEC) = 3read(3, &quot;\\177ELF\\2\\1\\1\\0\\0\\0\\0\\0\\0\\0\\0\\0\\3\\0&gt;\\0\\1\\0\\0\\0P\\16\\0\\0\\0\\0\\0\\0&quot;..., 832) = 832fstat(3, &#123;st_mode=S_IFREG|0644, st_size=14560, ...&#125;) = 0mmap(NULL, 2109712, PROT_READ|PROT_EXEC, MAP_PRIVATE|MAP_DENYWRITE, 3, 0) = 0x7f897f922000mprotect(0x7f897f925000, 2093056, PROT_NONE) = 0mmap(0x7f897fb24000, 8192, PROT_READ|PROT_WRITE, MAP_PRIVATE|MAP_FIXED|MAP_DENYWRITE, 3, 0x2000) = 0x7f897fb24000close(3)                                = 0openat(AT_FDCWD, &quot;/opt/ros/melodic/lib/libpthread.so.0&quot;, O_RDONLY|O_CLOEXEC) = -1 ENOENT (No such file or directory)access(&quot;/etc/ld.so.nohwcap&quot;, F_OK)      = -1 ENOENT (No such file or directory)openat(AT_FDCWD, &quot;/lib/x86_64-linux-gnu/libpthread.so.0&quot;, O_RDONLY|O_CLOEXEC) = 3read(3, &quot;\\177ELF\\2\\1\\1\\0\\0\\0\\0\\0\\0\\0\\0\\0\\3\\0&gt;\\0\\1\\0\\0\\0000b\\0\\0\\0\\0\\0\\0&quot;..., 832) = 832fstat(3, &#123;st_mode=S_IFREG|0755, st_size=144976, ...&#125;) = 0mmap(NULL, 8192, PROT_READ|PROT_WRITE, MAP_PRIVATE|MAP_ANONYMOUS, -1, 0) = 0x7f89809ab000mmap(NULL, 2221184, PROT_READ|PROT_EXEC, MAP_PRIVATE|MAP_DENYWRITE, 3, 0) = 0x7f897f703000mprotect(0x7f897f71d000, 2093056, PROT_NONE) = 0mmap(0x7f897f91c000, 8192, PROT_READ|PROT_WRITE, MAP_PRIVATE|MAP_FIXED|MAP_DENYWRITE, 3, 0x19000) = 0x7f897f91c000mmap(0x7f897f91e000, 13440, PROT_READ|PROT_WRITE, MAP_PRIVATE|MAP_FIXED|MAP_ANONYMOUS, -1, 0) = 0x7f897f91e000close(3)                                = 0mmap(NULL, 12288, PROT_READ|PROT_WRITE, MAP_PRIVATE|MAP_ANONYMOUS, -1, 0) = 0x7f89809a8000arch_prctl(ARCH_SET_FS, 0x7f89809a8800) = 0mprotect(0x7f898017e000, 16384, PROT_READ) = 0mprotect(0x7f897f91c000, 4096, PROT_READ) = 0mprotect(0x7f897fb24000, 4096, PROT_READ) = 0mprotect(0x7f897fd95000, 4096, PROT_READ) = 0mprotect(0x7f898038b000, 4096, PROT_READ) = 0mprotect(0x7f8980593000, 4096, PROT_READ) = 0mprotect(0x7f89807b9000, 4096, PROT_READ) = 0mprotect(0x55a403631000, 4096, PROT_READ) = 0mprotect(0x7f89809e6000, 4096, PROT_READ) = 0munmap(0x7f89809af000, 223218)          = 0set_tid_address(0x7f89809a8ad0)         = 5123set_robust_list(0x7f89809a8ae0, 24)     = 0rt_sigaction(SIGRTMIN, &#123;sa_handler=0x7f897f708cb0, sa_mask=[], sa_flags=SA_RESTORER|SA_SIGINFO, sa_restorer=0x7f897f715980&#125;, NULL, 8) = 0rt_sigaction(SIGRT_1, &#123;sa_handler=0x7f897f708d50, sa_mask=[], sa_flags=SA_RESTORER|SA_RESTART|SA_SIGINFO, sa_restorer=0x7f897f715980&#125;, NULL, 8) = 0rt_sigprocmask(SIG_UNBLOCK, [RTMIN RT_1], NULL, 8) = 0prlimit64(0, RLIMIT_STACK, NULL, &#123;rlim_cur=8192*1024, rlim_max=RLIM64_INFINITY&#125;) = 0statfs(&quot;/sys/fs/selinux&quot;, 0x7ffcc58a7b60) = -1 ENOENT (No such file or directory)statfs(&quot;/selinux&quot;, 0x7ffcc58a7b60)      = -1 ENOENT (No such file or directory)brk(NULL)                               = 0x55a404a95000brk(0x55a404ab6000)                     = 0x55a404ab6000openat(AT_FDCWD, &quot;/proc/filesystems&quot;, O_RDONLY|O_CLOEXEC) = 3fstat(3, &#123;st_mode=S_IFREG|0444, st_size=0, ...&#125;) = 0read(3, &quot;nodev\\tsysfs\\nnodev\\ttmpfs\\nnodev\\tbd&quot;..., 1024) = 393read(3, &quot;&quot;, 1024)                       = 0close(3)                                = 0access(&quot;/etc/selinux/config&quot;, F_OK)     = -1 ENOENT (No such file or directory)openat(AT_FDCWD, &quot;/usr/lib/locale/locale-archive&quot;, O_RDONLY|O_CLOEXEC) = 3fstat(3, &#123;st_mode=S_IFREG|0644, st_size=5513488, ...&#125;) = 0mmap(NULL, 5513488, PROT_READ, MAP_PRIVATE, 3, 0) = 0x7f897f1c0000close(3)                                = 0geteuid()                               = 1000stat(&quot;b&quot;, &#123;st_mode=S_IFREG|0664, st_size=7, ...&#125;) = 0stat(&quot;a&quot;, &#123;st_mode=S_IFREG|0664, st_size=7, ...&#125;) = 0stat(&quot;b&quot;, &#123;st_mode=S_IFREG|0664, st_size=7, ...&#125;) = 0openat(AT_FDCWD, &quot;a&quot;, O_RDONLY)         = 3fstat(3, &#123;st_mode=S_IFREG|0664, st_size=7, ...&#125;) = 0openat(AT_FDCWD, &quot;b&quot;, O_WRONLY|O_TRUNC) = 4fstat(4, &#123;st_mode=S_IFREG|0664, st_size=0, ...&#125;) = 0fadvise64(3, 0, 0, POSIX_FADV_SEQUENTIAL) = 0mmap(NULL, 139264, PROT_READ|PROT_WRITE, MAP_PRIVATE|MAP_ANONYMOUS, -1, 0) = 0x7f89809c4000read(3, &quot;file a\\n&quot;, 131072)             = 7write(4, &quot;file a\\n&quot;, 7)                 = 7read(3, &quot;&quot;, 131072)                     = 0close(4)                                = 0close(3)                                = 0munmap(0x7f89809c4000, 139264)          = 0lseek(0, 0, SEEK_CUR)                   = -1 ESPIPE (Illegal seek)close(0)                                = 0close(1)                                = 0close(2)                                = 0exit_group(0)                           = ?+++ exited with 0 +++\n\n\nstrace 命令跟踪 mv 执行过程12345678$ cat afile a$ cat bfile b$ strace mv a b...rename(&quot;a&quot;, &quot;b&quot;)                        = 0...\n\ndetails\n\n123456789101112131415161718192021222324252627282930313233343536373839404142434445464748495051525354555657585960616263646566676869707172737475767778798081828384858687888990919293949596979899100101102103104105106107108109110111112113114115116117118119120121122123124125126127128129130131132133134135136137138139140141142143$ strace mv a bexecve(&quot;/bin/mv&quot;, [&quot;mv&quot;, &quot;a&quot;, &quot;b&quot;], 0x7fffb37729b0 /* 78 vars */) = 0brk(NULL)                               = 0x55b38eebf000access(&quot;/etc/ld.so.nohwcap&quot;, F_OK)      = -1 ENOENT (No such file or directory)access(&quot;/etc/ld.so.preload&quot;, R_OK)      = -1 ENOENT (No such file or directory)openat(AT_FDCWD, &quot;/opt/ros/melodic/lib/tls/haswell/x86_64/libselinux.so.1&quot;, O_RDONLY|O_CLOEXEC) = -1 ENOENT (No such file or directory)stat(&quot;/opt/ros/melodic/lib/tls/haswell/x86_64&quot;, 0x7ffc2d702d20) = -1 ENOENT (No such file or directory)openat(AT_FDCWD, &quot;/opt/ros/melodic/lib/tls/haswell/libselinux.so.1&quot;, O_RDONLY|O_CLOEXEC) = -1 ENOENT (No such file or directory)stat(&quot;/opt/ros/melodic/lib/tls/haswell&quot;, 0x7ffc2d702d20) = -1 ENOENT (No such file or directory)openat(AT_FDCWD, &quot;/opt/ros/melodic/lib/tls/x86_64/libselinux.so.1&quot;, O_RDONLY|O_CLOEXEC) = -1 ENOENT (No such file or directory)stat(&quot;/opt/ros/melodic/lib/tls/x86_64&quot;, 0x7ffc2d702d20) = -1 ENOENT (No such file or directory)openat(AT_FDCWD, &quot;/opt/ros/melodic/lib/tls/libselinux.so.1&quot;, O_RDONLY|O_CLOEXEC) = -1 ENOENT (No such file or directory)stat(&quot;/opt/ros/melodic/lib/tls&quot;, 0x7ffc2d702d20) = -1 ENOENT (No such file or directory)openat(AT_FDCWD, &quot;/opt/ros/melodic/lib/haswell/x86_64/libselinux.so.1&quot;, O_RDONLY|O_CLOEXEC) = -1 ENOENT (No such file or directory)stat(&quot;/opt/ros/melodic/lib/haswell/x86_64&quot;, 0x7ffc2d702d20) = -1 ENOENT (No such file or directory)openat(AT_FDCWD, &quot;/opt/ros/melodic/lib/haswell/libselinux.so.1&quot;, O_RDONLY|O_CLOEXEC) = -1 ENOENT (No such file or directory)stat(&quot;/opt/ros/melodic/lib/haswell&quot;, 0x7ffc2d702d20) = -1 ENOENT (No such file or directory)openat(AT_FDCWD, &quot;/opt/ros/melodic/lib/x86_64/libselinux.so.1&quot;, O_RDONLY|O_CLOEXEC) = -1 ENOENT (No such file or directory)stat(&quot;/opt/ros/melodic/lib/x86_64&quot;, 0x7ffc2d702d20) = -1 ENOENT (No such file or directory)openat(AT_FDCWD, &quot;/opt/ros/melodic/lib/libselinux.so.1&quot;, O_RDONLY|O_CLOEXEC) = -1 ENOENT (No such file or directory)stat(&quot;/opt/ros/melodic/lib&quot;, &#123;st_mode=S_IFDIR|0755, st_size=36864, ...&#125;) = 0openat(AT_FDCWD, &quot;/etc/ld.so.cache&quot;, O_RDONLY|O_CLOEXEC) = 3fstat(3, &#123;st_mode=S_IFREG|0644, st_size=223218, ...&#125;) = 0mmap(NULL, 223218, PROT_READ, MAP_PRIVATE, 3, 0) = 0x7f615a44d000close(3)                                = 0access(&quot;/etc/ld.so.nohwcap&quot;, F_OK)      = -1 ENOENT (No such file or directory)openat(AT_FDCWD, &quot;/lib/x86_64-linux-gnu/libselinux.so.1&quot;, O_RDONLY|O_CLOEXEC) = 3read(3, &quot;\\177ELF\\2\\1\\1\\0\\0\\0\\0\\0\\0\\0\\0\\0\\3\\0&gt;\\0\\1\\0\\0\\0\\20b\\0\\0\\0\\0\\0\\0&quot;..., 832) = 832fstat(3, &#123;st_mode=S_IFREG|0644, st_size=154832, ...&#125;) = 0mmap(NULL, 8192, PROT_READ|PROT_WRITE, MAP_PRIVATE|MAP_ANONYMOUS, -1, 0) = 0x7f615a44b000mmap(NULL, 2259152, PROT_READ|PROT_EXEC, MAP_PRIVATE|MAP_DENYWRITE, 3, 0) = 0x7f615a033000mprotect(0x7f615a058000, 2093056, PROT_NONE) = 0mmap(0x7f615a257000, 8192, PROT_READ|PROT_WRITE, MAP_PRIVATE|MAP_FIXED|MAP_DENYWRITE, 3, 0x24000) = 0x7f615a257000mmap(0x7f615a259000, 6352, PROT_READ|PROT_WRITE, MAP_PRIVATE|MAP_FIXED|MAP_ANONYMOUS, -1, 0) = 0x7f615a259000close(3)                                = 0openat(AT_FDCWD, &quot;/opt/ros/melodic/lib/libacl.so.1&quot;, O_RDONLY|O_CLOEXEC) = -1 ENOENT (No such file or directory)access(&quot;/etc/ld.so.nohwcap&quot;, F_OK)      = -1 ENOENT (No such file or directory)openat(AT_FDCWD, &quot;/lib/x86_64-linux-gnu/libacl.so.1&quot;, O_RDONLY|O_CLOEXEC) = 3read(3, &quot;\\177ELF\\2\\1\\1\\0\\0\\0\\0\\0\\0\\0\\0\\0\\3\\0&gt;\\0\\1\\0\\0\\0\\340\\33\\0\\0\\0\\0\\0\\0&quot;..., 832) = 832fstat(3, &#123;st_mode=S_IFREG|0644, st_size=31232, ...&#125;) = 0mmap(NULL, 2126336, PROT_READ|PROT_EXEC, MAP_PRIVATE|MAP_DENYWRITE, 3, 0) = 0x7f6159e2b000mprotect(0x7f6159e32000, 2093056, PROT_NONE) = 0mmap(0x7f615a031000, 8192, PROT_READ|PROT_WRITE, MAP_PRIVATE|MAP_FIXED|MAP_DENYWRITE, 3, 0x6000) = 0x7f615a031000close(3)                                = 0openat(AT_FDCWD, &quot;/opt/ros/melodic/lib/libattr.so.1&quot;, O_RDONLY|O_CLOEXEC) = -1 ENOENT (No such file or directory)access(&quot;/etc/ld.so.nohwcap&quot;, F_OK)      = -1 ENOENT (No such file or directory)openat(AT_FDCWD, &quot;/lib/x86_64-linux-gnu/libattr.so.1&quot;, O_RDONLY|O_CLOEXEC) = 3read(3, &quot;\\177ELF\\2\\1\\1\\0\\0\\0\\0\\0\\0\\0\\0\\0\\3\\0&gt;\\0\\1\\0\\0\\0\\260\\20\\0\\0\\0\\0\\0\\0&quot;..., 832) = 832fstat(3, &#123;st_mode=S_IFREG|0644, st_size=18680, ...&#125;) = 0mmap(NULL, 2113752, PROT_READ|PROT_EXEC, MAP_PRIVATE|MAP_DENYWRITE, 3, 0) = 0x7f6159c26000mprotect(0x7f6159c2a000, 2093056, PROT_NONE) = 0mmap(0x7f6159e29000, 8192, PROT_READ|PROT_WRITE, MAP_PRIVATE|MAP_FIXED|MAP_DENYWRITE, 3, 0x3000) = 0x7f6159e29000close(3)                                = 0openat(AT_FDCWD, &quot;/opt/ros/melodic/lib/libc.so.6&quot;, O_RDONLY|O_CLOEXEC) = -1 ENOENT (No such file or directory)access(&quot;/etc/ld.so.nohwcap&quot;, F_OK)      = -1 ENOENT (No such file or directory)openat(AT_FDCWD, &quot;/lib/x86_64-linux-gnu/libc.so.6&quot;, O_RDONLY|O_CLOEXEC) = 3read(3, &quot;\\177ELF\\2\\1\\1\\3\\0\\0\\0\\0\\0\\0\\0\\0\\3\\0&gt;\\0\\1\\0\\0\\0\\240\\35\\2\\0\\0\\0\\0\\0&quot;..., 832) = 832fstat(3, &#123;st_mode=S_IFREG|0755, st_size=2030928, ...&#125;) = 0mmap(NULL, 4131552, PROT_READ|PROT_EXEC, MAP_PRIVATE|MAP_DENYWRITE, 3, 0) = 0x7f6159835000mprotect(0x7f6159a1c000, 2097152, PROT_NONE) = 0mmap(0x7f6159c1c000, 24576, PROT_READ|PROT_WRITE, MAP_PRIVATE|MAP_FIXED|MAP_DENYWRITE, 3, 0x1e7000) = 0x7f6159c1c000mmap(0x7f6159c22000, 15072, PROT_READ|PROT_WRITE, MAP_PRIVATE|MAP_FIXED|MAP_ANONYMOUS, -1, 0) = 0x7f6159c22000close(3)                                = 0openat(AT_FDCWD, &quot;/opt/ros/melodic/lib/libpcre.so.3&quot;, O_RDONLY|O_CLOEXEC) = -1 ENOENT (No such file or directory)access(&quot;/etc/ld.so.nohwcap&quot;, F_OK)      = -1 ENOENT (No such file or directory)openat(AT_FDCWD, &quot;/lib/x86_64-linux-gnu/libpcre.so.3&quot;, O_RDONLY|O_CLOEXEC) = 3read(3, &quot;\\177ELF\\2\\1\\1\\0\\0\\0\\0\\0\\0\\0\\0\\0\\3\\0&gt;\\0\\1\\0\\0\\0 \\25\\0\\0\\0\\0\\0\\0&quot;..., 832) = 832fstat(3, &#123;st_mode=S_IFREG|0644, st_size=460728, ...&#125;) = 0mmap(NULL, 2556168, PROT_READ|PROT_EXEC, MAP_PRIVATE|MAP_DENYWRITE, 3, 0) = 0x7f61595c4000mprotect(0x7f6159634000, 2093056, PROT_NONE) = 0mmap(0x7f6159833000, 8192, PROT_READ|PROT_WRITE, MAP_PRIVATE|MAP_FIXED|MAP_DENYWRITE, 3, 0x6f000) = 0x7f6159833000close(3)                                = 0openat(AT_FDCWD, &quot;/opt/ros/melodic/lib/libdl.so.2&quot;, O_RDONLY|O_CLOEXEC) = -1 ENOENT (No such file or directory)access(&quot;/etc/ld.so.nohwcap&quot;, F_OK)      = -1 ENOENT (No such file or directory)openat(AT_FDCWD, &quot;/lib/x86_64-linux-gnu/libdl.so.2&quot;, O_RDONLY|O_CLOEXEC) = 3read(3, &quot;\\177ELF\\2\\1\\1\\0\\0\\0\\0\\0\\0\\0\\0\\0\\3\\0&gt;\\0\\1\\0\\0\\0P\\16\\0\\0\\0\\0\\0\\0&quot;..., 832) = 832fstat(3, &#123;st_mode=S_IFREG|0644, st_size=14560, ...&#125;) = 0mmap(NULL, 2109712, PROT_READ|PROT_EXEC, MAP_PRIVATE|MAP_DENYWRITE, 3, 0) = 0x7f61593c0000mprotect(0x7f61593c3000, 2093056, PROT_NONE) = 0mmap(0x7f61595c2000, 8192, PROT_READ|PROT_WRITE, MAP_PRIVATE|MAP_FIXED|MAP_DENYWRITE, 3, 0x2000) = 0x7f61595c2000close(3)                                = 0openat(AT_FDCWD, &quot;/opt/ros/melodic/lib/libpthread.so.0&quot;, O_RDONLY|O_CLOEXEC) = -1 ENOENT (No such file or directory)access(&quot;/etc/ld.so.nohwcap&quot;, F_OK)      = -1 ENOENT (No such file or directory)openat(AT_FDCWD, &quot;/lib/x86_64-linux-gnu/libpthread.so.0&quot;, O_RDONLY|O_CLOEXEC) = 3read(3, &quot;\\177ELF\\2\\1\\1\\0\\0\\0\\0\\0\\0\\0\\0\\0\\3\\0&gt;\\0\\1\\0\\0\\0000b\\0\\0\\0\\0\\0\\0&quot;..., 832) = 832fstat(3, &#123;st_mode=S_IFREG|0755, st_size=144976, ...&#125;) = 0mmap(NULL, 8192, PROT_READ|PROT_WRITE, MAP_PRIVATE|MAP_ANONYMOUS, -1, 0) = 0x7f615a449000mmap(NULL, 2221184, PROT_READ|PROT_EXEC, MAP_PRIVATE|MAP_DENYWRITE, 3, 0) = 0x7f61591a1000mprotect(0x7f61591bb000, 2093056, PROT_NONE) = 0mmap(0x7f61593ba000, 8192, PROT_READ|PROT_WRITE, MAP_PRIVATE|MAP_FIXED|MAP_DENYWRITE, 3, 0x19000) = 0x7f61593ba000mmap(0x7f61593bc000, 13440, PROT_READ|PROT_WRITE, MAP_PRIVATE|MAP_FIXED|MAP_ANONYMOUS, -1, 0) = 0x7f61593bc000close(3)                                = 0mmap(NULL, 12288, PROT_READ|PROT_WRITE, MAP_PRIVATE|MAP_ANONYMOUS, -1, 0) = 0x7f615a446000arch_prctl(ARCH_SET_FS, 0x7f615a446800) = 0mprotect(0x7f6159c1c000, 16384, PROT_READ) = 0mprotect(0x7f61593ba000, 4096, PROT_READ) = 0mprotect(0x7f61595c2000, 4096, PROT_READ) = 0mprotect(0x7f6159833000, 4096, PROT_READ) = 0mprotect(0x7f6159e29000, 4096, PROT_READ) = 0mprotect(0x7f615a031000, 4096, PROT_READ) = 0mprotect(0x7f615a257000, 4096, PROT_READ) = 0mprotect(0x55b38e8b8000, 4096, PROT_READ) = 0mprotect(0x7f615a484000, 4096, PROT_READ) = 0munmap(0x7f615a44d000, 223218)          = 0set_tid_address(0x7f615a446ad0)         = 6068set_robust_list(0x7f615a446ae0, 24)     = 0rt_sigaction(SIGRTMIN, &#123;sa_handler=0x7f61591a6cb0, sa_mask=[], sa_flags=SA_RESTORER|SA_SIGINFO, sa_restorer=0x7f61591b3980&#125;, NULL, 8) = 0rt_sigaction(SIGRT_1, &#123;sa_handler=0x7f61591a6d50, sa_mask=[], sa_flags=SA_RESTORER|SA_RESTART|SA_SIGINFO, sa_restorer=0x7f61591b3980&#125;, NULL, 8) = 0rt_sigprocmask(SIG_UNBLOCK, [RTMIN RT_1], NULL, 8) = 0prlimit64(0, RLIMIT_STACK, NULL, &#123;rlim_cur=8192*1024, rlim_max=RLIM64_INFINITY&#125;) = 0statfs(&quot;/sys/fs/selinux&quot;, 0x7ffc2d703630) = -1 ENOENT (No such file or directory)statfs(&quot;/selinux&quot;, 0x7ffc2d703630)      = -1 ENOENT (No such file or directory)brk(NULL)                               = 0x55b38eebf000brk(0x55b38eee0000)                     = 0x55b38eee0000openat(AT_FDCWD, &quot;/proc/filesystems&quot;, O_RDONLY|O_CLOEXEC) = 3fstat(3, &#123;st_mode=S_IFREG|0444, st_size=0, ...&#125;) = 0read(3, &quot;nodev\\tsysfs\\nnodev\\ttmpfs\\nnodev\\tbd&quot;..., 1024) = 393read(3, &quot;&quot;, 1024)                       = 0close(3)                                = 0access(&quot;/etc/selinux/config&quot;, F_OK)     = -1 ENOENT (No such file or directory)openat(AT_FDCWD, &quot;/usr/lib/locale/locale-archive&quot;, O_RDONLY|O_CLOEXEC) = 3fstat(3, &#123;st_mode=S_IFREG|0644, st_size=5513488, ...&#125;) = 0mmap(NULL, 5513488, PROT_READ, MAP_PRIVATE, 3, 0) = 0x7f6158c5e000close(3)                                = 0geteuid()                               = 1000ioctl(0, TCGETS, &#123;B38400 opost isig icanon echo ...&#125;) = 0stat(&quot;b&quot;, &#123;st_mode=S_IFREG|0664, st_size=7, ...&#125;) = 0lstat(&quot;a&quot;, &#123;st_mode=S_IFREG|0664, st_size=7, ...&#125;) = 0lstat(&quot;b&quot;, &#123;st_mode=S_IFREG|0664, st_size=7, ...&#125;) = 0geteuid()                               = 1000stat(&quot;b&quot;, &#123;st_mode=S_IFREG|0664, st_size=7, ...&#125;) = 0geteuid()                               = 1000getegid()                               = 1000getuid()                                = 1000getgid()                                = 1000access(&quot;b&quot;, W_OK)                       = 0rename(&quot;a&quot;, &quot;b&quot;)                        = 0lseek(0, 0, SEEK_CUR)                   = -1 ESPIPE (Illegal seek)close(0)                                = 0close(1)                                = 0close(2)                                = 0exit_group(0)                           = ?+++ exited with 0 +++\n\n\n动态库应用程序使用动态库过程\n\n应用程序通过 dlopen 打开 so 时，内核通过 mmap 将 so 加载到进程地址空间，对应虚拟内存区域 VMA 中的页 page\n加载器 loader 将 so 里引用的外部符号解析成真正的虚拟地址\n当 so 被 cp trunc 时，内核将旧 so 文件从虚拟内存对应物理内存中清除\n当应用程序运行到 so 中的代码时，产生缺页中断\n内核重新加载新 so\n如果文件偏移量超出新 so 地址范围，将产生 bus error\n如果新 so 依赖外部符号，此时全局符号表没有经过重新解析，将产生段错误\n如果新 so 不依赖外部符号，程序可以运行\n\n\n\n测试库文件1234567891011#include &lt;stdio.h&gt;void func(void) &#123;  printf(&quot;new lib\\n&quot;);  printf(&quot;old lib\\n&quot;);&#125;void add(void) &#123;  int a = 1, b = 2;  int c = a + b;&#125;\n测试文件12345678910111213141516171819202122232425262728293031#include &lt;dlfcn.h&gt;#include &lt;stdio.h&gt;int main() &#123;  void* handle;  void (*func)(void);  void (*add)(void);  handle = dlopen(&quot;libtest.so&quot;, RTLD_LAZY);  if (!handle) &#123;    fprintf(stderr, &quot;%s\\n&quot;, dlerror());    return -1;  &#125;  func = dlsym(handle, &quot;func&quot;);  if (dlerror() != NULL) &#123;    fprintf(stderr, &quot;%s\\n&quot;, dlerror());    return -1;  &#125;  func();  add = dlsym(handle, &quot;add&quot;);  if (dlerror() != NULL) &#123;    fprintf(stderr, &quot;%s\\n&quot;, dlerror());    return -1;  &#125;  add();  dlclose(handle);&#125;\n编译12$ gcc -fPIC -shared -o libtest.so libtest.c -g$ gcc -o use_lib use_lib.c -ldl -g\n-g 生成调试信息\n-fPIC 生成位置无关代码(Position-Independent Code)，创建共享库时允许代码在任何内存地址执行而无需修改\n报错解决，修改 LD_PRELOAD 无效12libtest.so: cannot open shared object file: No such file or directory$ export LD_LIBRARY_PATH=$(pwd):$LD_LIBRARY_PATH\ngdb 调试：函数调用处添加断点后，在另一终端 cp 替换库文件 so，回到 gdb n 继续单步运行\n\nfunc 函数断点调试\n\n12345678910111213141516171819$ gdb use_libGNU gdb (Ubuntu 8.1.1-0ubuntu1) 8.1.1...Reading symbols from use_lib...done.(gdb) b 20Breakpoint 1 at 0x876: file use_lib.c, line 20.(gdb) rStarting program: /home/nolehuan/cpp/src/use_lib Breakpoint 1, main () at use_lib.c:2020\t  func();(gdb) nProgram received signal SIGSEGV, Segmentation fault.0x0000000000000536 in ?? ()(gdb) bt#0  0x0000000000000536 in ?? ()#1  0x00007ffff75dc63a in func () at libtest.c:4#2  0x000055555555487c in main () at use_lib.c:20\n\nadd 函数断点调试\n\n1234567891011121314$ gdb use_libGNU gdb (Ubuntu 8.1.1-0ubuntu1) 8.1.1...Reading symbols from use_lib...done.(gdb) b 27Breakpoint 1 at 0x8c7: file use_lib.c, line 27.(gdb) rStarting program: /home/nolehuan/cpp/src/use_lib old libBreakpoint 1, main () at use_lib.c:2727\t  add();(gdb) n29\t  dlclose(handle);\n结论\ncp 更新动态库，文件 inode 号不变，旧库文件被截断，重新加载至内存时，或因为文件偏移量超出新库文件地址范围产生 bus error 导致程序 core 掉，或因为动态库依赖外部符号但全局符号表没有经过重新解析产生段错误导致程序 core 掉\nmv 更新动态库，文件 inode 号改变，旧 inode 号依然存在，程序可以继续运行，必须重启服务才会加载新动态库\n\n正确做法rm + cp 或 mv + cp\nrm 时如果 ld.so 正在加载动态库，inode 不会立刻被删除，直至 ld.so 释放对动态库的引用，引用结束时才会真正删除 inode，程序不会崩溃，下次使用替换后的动态库\nmv 仅改变文件名，inode 不变，新动态库使用新 inode，动态链接器 ld.so 使用原 inode 访问旧动态库\n替换可执行程序时，系统会明令禁止 cp 操作，但系统不会阻止覆盖动态库12cp xxx xxxcp: cannot create regular file `xxx`: Text file busy\nDemand Paging 机制\n程序运行时并非所有页都加载到内存中，只有需要访问时才会动态加载，Demand Paging 要求正在运行中的程序镜像不被意外修改，因此内核会锁定程序镜像的 inode\n对于动态库而言，依靠用户态程序 ld.so 加载，无权锁定 inode\n相关内容环境变量\n\nLIBRARY_PATH 静态链接库文件搜索路径\nLD_LIBRARY_PATH 动态链接库文件搜索路径\n\n动态库 .so 与静态库 .a 同时存在时，gcc/g++ 默认链接动态库，可使用参数 -Wl,-Bstatic -lxxx 或 -Wl,-Bdynamic -lxxx 指定链接静态/动态库\n参数 -static 指定完全静态加载\n静态库加载顺序\n\ngcc -L 参数\nLIBRARY_PATH\n默认库目录\n\n动态库加载顺序\n\ngcc -L 参数\nLD_LIBRARY_PATH\n/etc/ld.so.conf 配置文件中的路径\n默认库目录\n\nldd 查看可执行程序依赖的共享库\n动态库命名：libxxxx.so.major.minor，major 主版本号，minor 副版本号 \ngcc 分阶段编译123$ gcc -E libtest.c -o libtest.i$ gcc -S libtest.i -o libtest.s$ gcc -c libtest.s -o libtest.o\n生成静态库1$ ar cqs libtest.a libtest.o\nar archivec 创建新的归档文件，已存在则覆盖q 快速追加s 构建对象索引文件，即符号表\nnm 查看库中的函数\n\nT 函数在当前库中定义\nU 函数在其它库中定义被调用\nW 当前库中定义，被其它库中的函数覆盖\n\n1234567891011121314151617181920212223242526nm libtest.so000000000000063d T add0000000000201028 B __bss_start0000000000201028 b completed.7698                 w __cxa_finalize@@GLIBC_2.2.50000000000000550 t deregister_tm_clones00000000000005e0 t __do_global_dtors_aux0000000000200e18 t __do_global_dtors_aux_fini_array_entry0000000000201020 d __dso_handle0000000000200e20 d _DYNAMIC0000000000201028 D _edata0000000000201030 B _end0000000000000660 T _fini0000000000000620 t frame_dummy0000000000200e10 t __frame_dummy_init_array_entry0000000000000738 r __FRAME_END__000000000000062a T func0000000000201000 d _GLOBAL_OFFSET_TABLE_                 w __gmon_start__0000000000000674 r __GNU_EH_FRAME_HDR0000000000000500 T _init                 w _ITM_deregisterTMCloneTable                 w _ITM_registerTMCloneTable                 U puts@@GLIBC_2.2.50000000000000590 t register_tm_clones0000000000201028 d __TMC_END__\n1234567$ nm libtest.a libtest.o:0000000000000013 T add0000000000000000 T func                 U _GLOBAL_OFFSET_TABLE_                 U puts\n参考https://developer.aliyun.com/article/6371https://www.cnblogs.com/wangliangblog/p/10766986.htmlhttps://blog.csdn.net/BHJ1119/article/details/88219896\n","slug":"cpp/so","date":"2023-11-26T19:30:29.000Z","categories_index":"coding","tags_index":"cpp,linux,so","author_index":"NoleHuan"},{"id":"2b7dc717d2cad550b10ee602a360ec48","title":"daily","content":"x\n","slug":"daily/index","date":"2023-11-18T15:30:29.000Z","categories_index":"personal","tags_index":"daily","author_index":"NoleHuan"},{"id":"9126d7e35b9c1cf6438d81091e8f7d35","title":"resume","content":"2016.09-2017.01吉林大学 土地资源管理专业 学士\n\n管理学 地质学 矿物学\n\n2017.02-2020.06吉林大学 汽车服务工程专业 学士\n\n机械设计 汽车构造 力学 嵌入式\n\n保研\n\n\n2020.09-2023.01北京航空航天大学 车辆工程专业 硕士\n\n自动驾驶 深度学习 多视角几何\n\n2022.03-2022.06百度 自动驾驶技术部 算法研发实习生\n\n自动化标注 图像处理\n\n2023.02-2023.11京东 智能驾驶技术部 嵌入式软件工程师\n\n自动驾驶系统中间件\n\n2023.08-2023.11京东 仓储软件产品 轮岗\n\n技术产品经理/算法工程师/前端开发工程师\n\n竞品分析 多智能体路径规划 强化学习 前端\n\n\n","slug":"intro/index","date":"2023-11-18T15:30:29.000Z","categories_index":"personal","tags_index":"resume","author_index":"NoleHuan"},{"id":"3e3976292a3f582a48e0ad2083410fee","title":"map","content":"\noutlineoutline\ninline  inline\n\n","slug":"cpp/map","date":"2023-11-05T15:30:29.000Z","categories_index":"coding","tags_index":"cpp","author_index":"NoleHuan"}]